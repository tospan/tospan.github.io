<!DOCTYPE html>
<html>
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
  
  <title>Are two triangles in 2D space intersecting | 吐司片的博客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="You have two triangles in 2D space and want to know if they are intersecting. If you do some reasearch on the Internet you will find that the fastest way to check if two triangles are intersecting is">
<meta property="og:type" content="article">
<meta property="og:title" content="Are two triangles in 2D space intersecting">
<meta property="og:url" content="http://tospan.me/2017/02/05/Unity/Are-two-triangles-in-2D-space-intersecting/index.html">
<meta property="og:site_name" content="吐司片的博客">
<meta property="og:description" content="You have two triangles in 2D space and want to know if they are intersecting. If you do some reasearch on the Internet you will find that the fastest way to check if two triangles are intersecting is">
<meta property="og:image" content="https://raw.githubusercontent.com/tospan/tospan.github.io/source/source/_images/unity/aabb-intersection-test.png">
<meta property="og:image" content="https://raw.githubusercontent.com/tospan/tospan.github.io/source/source/_images/unity/line-triangle-intersection-test.png">
<meta property="og:image" content="https://raw.githubusercontent.com/tospan/tospan.github.io/source/source/_images/unity/line-triangle-intersection-test.png">
<meta property="og:updated_time" content="2017-02-08T03:23:23.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Are two triangles in 2D space intersecting">
<meta name="twitter:description" content="You have two triangles in 2D space and want to know if they are intersecting. If you do some reasearch on the Internet you will find that the fastest way to check if two triangles are intersecting is">
<meta name="twitter:image" content="https://raw.githubusercontent.com/tospan/tospan.github.io/source/source/_images/unity/aabb-intersection-test.png">
  
    <link rel="alternate" href="/atom.xml" title="吐司片的博客" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css"><!-- hexo-inject:begin --><!-- hexo-inject:end -->
  

</head>

<body>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">吐司片的博客</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">Work hard, play hard.</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://tospan.me"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-Unity/Are-two-triangles-in-2D-space-intersecting" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/02/05/Unity/Are-two-triangles-in-2D-space-intersecting/" class="article-date">
  <time datetime="2017-02-05T02:16:37.000Z" itemprop="datePublished">2017-02-05</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Game-Development/">Game Development</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Are two triangles in 2D space intersecting
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>You have two triangles in 2D space and want to know if they are intersecting. If you do some reasearch on the Internet you will find that the fastest way to check if two triangles are intersecting is to combine the following intersection methods:</p>
<ul>
<li><strong>Step 1.</strong> Approximate the triangles with rectangles and test if they intersect.</li>
<li><strong>Step 2.</strong> Check if any of the sides of one triangle is intersecting with any of the sides of the other triangle.</li>
<li><strong>Step 3.</strong> Check if any of the corners of one triangle is inside the other triangle, and vice versa.</li>
</ul>
<a id="more"></a>
<p>But before we begin we need a scene. You need to create the following:</p>
<ul>
<li>2 gameobjects with a mesh filter and mesh renderer attached to them. To display the triangles we will build triangle meshes and attach them to these gameobjects.</li>
<li>6 spheres, where 3 have one color and 3 have another color. These are the corners of our triangles.</li>
<li>2 cubes. These will be used to display the rectangles that will approximate our triangles.</li>
<li>1 empty gameobject to attach the c# script to.<br>Then add the following code (we will soon add each intersection method to this script):</li>
</ul>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">using</span> UnityEngine;</div><div class="line"><span class="keyword">using</span> System.Collections;</div><div class="line"></div><div class="line"><span class="comment">//Triangle-triangle intersection in 2D</span></div><div class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">TriangleTriangleIntersection</span> : <span class="title">MonoBehaviour</span> </div><div class="line">&#123;</div><div class="line">    <span class="comment">//Triangle corners</span></div><div class="line">    <span class="keyword">public</span> Transform[] triangle1Corners;</div><div class="line">    <span class="keyword">public</span> Transform[] triangle2Corners;</div><div class="line">    <span class="comment">//Triangle objects to which we will attach meshes showing the triangles</span></div><div class="line">    <span class="keyword">public</span> GameObject triangle1Obj;</div><div class="line">    <span class="keyword">public</span> GameObject triangle2Obj;</div><div class="line">    <span class="comment">//Boxes for debugging of bounding box around triangle</span></div><div class="line">    <span class="keyword">public</span> GameObject box1Obj;</div><div class="line">    <span class="keyword">public</span> GameObject box2Obj;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Update</span>(<span class="params"></span>) </span></div><div class="line">	&#123;</div><div class="line">        <span class="comment">//Get the positions of the triangles corners</span></div><div class="line">        Vector3 t1_p1 = triangle1Corners[<span class="number">0</span>].position;</div><div class="line">        Vector3 t1_p2 = triangle1Corners[<span class="number">1</span>].position;</div><div class="line">        Vector3 t1_p3 = triangle1Corners[<span class="number">2</span>].position;</div><div class="line"></div><div class="line">        Vector3 t2_p1 = triangle2Corners[<span class="number">0</span>].position;</div><div class="line">        Vector3 t2_p2 = triangle2Corners[<span class="number">1</span>].position;</div><div class="line">        Vector3 t2_p3 = triangle2Corners[<span class="number">2</span>].position;</div><div class="line"></div><div class="line">        <span class="comment">//Create new triangles</span></div><div class="line">        Triangle triangle1 = <span class="keyword">new</span> Triangle(t1_p1, t1_p2, t1_p3);</div><div class="line">        Triangle triangle2 = <span class="keyword">new</span> Triangle(t2_p1, t2_p2, t2_p3);</div><div class="line"></div><div class="line">        <span class="comment">//Build a triangle mesh between the corners</span></div><div class="line">        CreateTriangleMesh(triangle1, triangle1Obj);</div><div class="line">        CreateTriangleMesh(triangle2, triangle2Obj);</div><div class="line"></div><div class="line">        <span class="comment">//Check for intersection</span></div><div class="line">        <span class="keyword">if</span> (IsTriangleTriangleIntersecting(triangle1, triangle2))</div><div class="line">        &#123;</div><div class="line">            triangle1Obj.GetComponent&lt;MeshRenderer&gt;().material.color = Color.red;</div><div class="line">            triangle2Obj.GetComponent&lt;MeshRenderer&gt;().material.color = Color.red;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span></div><div class="line">        &#123;</div><div class="line">            triangle1Obj.GetComponent&lt;MeshRenderer&gt;().material.color = Color.blue;</div><div class="line">            triangle2Obj.GetComponent&lt;MeshRenderer&gt;().material.color = Color.blue;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">//The triangle-triangle intersection in 2D algorithm</span></div><div class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">IsTriangleTriangleIntersecting</span>(<span class="params">Triangle triangle1, Triangle triangle2</span>)</span></div><div class="line">    &#123;</div><div class="line">        <span class="keyword">bool</span> isIntersecting = <span class="literal">false</span>;</div><div class="line"></div><div class="line">        <span class="comment">//Step 1. AABB intersection</span></div><div class="line">        <span class="keyword">if</span> (IsIntersectingAABB(triangle1, triangle2))</div><div class="line">        &#123;</div><div class="line">            <span class="comment">//Step 2. Line segment - triangle intersection</span></div><div class="line">            <span class="keyword">if</span> (AreAnyLineSegmentsIntersecting(triangle1, triangle2))</div><div class="line">            &#123;</div><div class="line">                isIntersecting = <span class="literal">true</span>;</div><div class="line">            &#125;</div><div class="line">            <span class="comment">//Step 3. Point in triangle intersection - if one of the triangles is inside the other</span></div><div class="line">            <span class="function"><span class="keyword">else</span> <span class="title">if</span> (<span class="params">AreCornersIntersecting(triangle1, triangle2</span>))</span></div><div class="line">            &#123;</div><div class="line">                isIntersecting = <span class="literal">true</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">return</span> isIntersecting;</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">//</span></div><div class="line">    <span class="comment">// Other stuff</span></div><div class="line">    <span class="comment">//</span></div><div class="line"></div><div class="line">    <span class="comment">//Create a triangle mesh with 2 sides from 3 coordinates</span></div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">CreateTriangleMesh</span>(<span class="params">Triangle triangle, GameObject triangleObj</span>)</span></div><div class="line">    &#123;</div><div class="line">        <span class="comment">//The vertices</span></div><div class="line">        Vector3[] newVertices = <span class="keyword">new</span> Vector3[<span class="number">3</span>];</div><div class="line"></div><div class="line">        <span class="comment">//Add the vertices</span></div><div class="line">        newVertices[<span class="number">0</span>] = triangle.p1;</div><div class="line">        newVertices[<span class="number">1</span>] = triangle.p2;</div><div class="line">        newVertices[<span class="number">2</span>] = triangle.p3;</div><div class="line"></div><div class="line">        <span class="comment">//The triangles (6 because we need a bottom so we can move the corners the way we want)</span></div><div class="line">        <span class="keyword">int</span>[] newTriangles = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">6</span>];</div><div class="line"></div><div class="line">        newTriangles[<span class="number">0</span>] = <span class="number">2</span>;</div><div class="line">        newTriangles[<span class="number">1</span>] = <span class="number">1</span>;</div><div class="line">        newTriangles[<span class="number">2</span>] = <span class="number">0</span>;</div><div class="line"></div><div class="line">        newTriangles[<span class="number">3</span>] = <span class="number">0</span>;</div><div class="line">        newTriangles[<span class="number">4</span>] = <span class="number">1</span>;</div><div class="line">        newTriangles[<span class="number">5</span>] = <span class="number">2</span>;</div><div class="line"></div><div class="line">        <span class="comment">//Add everything to a mesh</span></div><div class="line">        Mesh newMesh = <span class="keyword">new</span> Mesh();</div><div class="line"></div><div class="line">        newMesh.vertices = newVertices;</div><div class="line">        newMesh.triangles = newTriangles;</div><div class="line"></div><div class="line">        <span class="comment">//Add the mesh to the object</span></div><div class="line">        triangleObj.GetComponent&lt;MeshFilter&gt;().mesh = newMesh;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">//To store triangle data to get cleaner code</span></div><div class="line">    <span class="keyword">public</span> <span class="keyword">struct</span> Triangle</div><div class="line">    &#123;</div><div class="line">        <span class="comment">//Corners of the triangle</span></div><div class="line">        <span class="keyword">public</span> Vector3 p1, p2, p3;</div><div class="line">        <span class="comment">//The 3 line segments that make up this triangle</span></div><div class="line">        <span class="keyword">public</span> LineSegment[] lineSegments;</div><div class="line"></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Triangle</span>(<span class="params">Vector3 p1, Vector3 p2, Vector3 p3</span>)</span></div><div class="line">        &#123;</div><div class="line">            <span class="keyword">this</span>.p1 = p1;</div><div class="line">            <span class="keyword">this</span>.p2 = p2;</div><div class="line">            <span class="keyword">this</span>.p3 = p3;</div><div class="line"></div><div class="line">            lineSegments = <span class="keyword">new</span> LineSegment[<span class="number">3</span>];</div><div class="line"></div><div class="line">            lineSegments[<span class="number">0</span>] = <span class="keyword">new</span> LineSegment(p1, p2);</div><div class="line">            lineSegments[<span class="number">1</span>] = <span class="keyword">new</span> LineSegment(p2, p3);</div><div class="line">            lineSegments[<span class="number">2</span>] = <span class="keyword">new</span> LineSegment(p3, p1);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">//To create a line segment</span></div><div class="line">    <span class="keyword">public</span> <span class="keyword">struct</span> LineSegment</div><div class="line">    &#123;</div><div class="line">        <span class="comment">//Start/end coordinates</span></div><div class="line">        <span class="keyword">public</span> Vector3 p1, p2;</div><div class="line"></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="title">LineSegment</span>(<span class="params">Vector3 p1, Vector3 p2</span>)</span></div><div class="line">        &#123;</div><div class="line">            <span class="keyword">this</span>.p1 = p1;</div><div class="line">            <span class="keyword">this</span>.p2 = p2;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Step-1-AABB-intersection"><a href="#Step-1-AABB-intersection" class="headerlink" title="Step 1. AABB intersection"></a>Step 1. AABB intersection</h2><p>AABB is short for Axis-Aligned Bounding Box and is an intersection method to test if 2 rectangles (with no rotation) intersect in 2D space. You don’t really need this method to test if 2 triangles are intersecting, but if you are using it, it will make the algorithm faster because it’s faster to just test if 2 rectangles are intersecting before we test if the triangles are intersecting.</p>
<p>The basic idea is that you test 8 different values, but if just 2 of them are “failing” the algorithm stops, which is why this method is fast. If you want a better explanation of the algorithm, you can watch this YouTube video: <a href="https://www.youtube.com/watch?v=ENuk9HgeTiI" target="_blank" rel="external">Math for Game Developers - Trigger Areas (AABB Intersection).</a></p>
<p>To approximate the triangles with rectangles, we just check each corner of each triangle and find the maximum and minimum value of both x and z coordinates.</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">// Intersection: AABB</span></div><div class="line"><span class="comment">//</span></div><div class="line"></div><div class="line"><span class="comment">//Approximate the triangles with rectangles and see if they intersect with the AABB intersection algorithm</span></div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">IsIntersectingAABB</span>(<span class="params">Triangle t1, Triangle t2</span>)</span></div><div class="line">&#123;</div><div class="line">	<span class="comment">//Find the size of the bounding box</span></div><div class="line"></div><div class="line">	<span class="comment">//Triangle 1</span></div><div class="line">	<span class="keyword">float</span> t1_minX = Mathf.Min(t1.p1.x, Mathf.Min(t1.p2.x, t1.p3.x));</div><div class="line">	<span class="keyword">float</span> t1_maxX = Mathf.Max(t1.p1.x, Mathf.Max(t1.p2.x, t1.p3.x));</div><div class="line">	<span class="keyword">float</span> t1_minZ = Mathf.Min(t1.p1.z, Mathf.Min(t1.p2.z, t1.p3.z));</div><div class="line">	<span class="keyword">float</span> t1_maxZ = Mathf.Max(t1.p1.z, Mathf.Max(t1.p2.z, t1.p3.z));</div><div class="line"></div><div class="line">	<span class="comment">//Triangle 2</span></div><div class="line">	<span class="keyword">float</span> t2_minX = Mathf.Min(t2.p1.x, Mathf.Min(t2.p2.x, t2.p3.x));</div><div class="line">	<span class="keyword">float</span> t2_maxX = Mathf.Max(t2.p1.x, Mathf.Max(t2.p2.x, t2.p3.x));</div><div class="line">	<span class="keyword">float</span> t2_minZ = Mathf.Min(t2.p1.z, Mathf.Min(t2.p2.z, t2.p3.z));</div><div class="line">	<span class="keyword">float</span> t2_maxZ = Mathf.Max(t2.p1.z, Mathf.Max(t2.p2.z, t2.p3.z));</div><div class="line"></div><div class="line"></div><div class="line">	<span class="comment">//Are the rectangles intersecting?</span></div><div class="line">	<span class="comment">//If the min of one box in one dimension is greater than the max of another box then the boxes are not intersecting</span></div><div class="line">	<span class="comment">//They have to intersect in 2 dimensions. We have to test if box 1 is to the left or box 2 and vice versa</span></div><div class="line">	<span class="keyword">bool</span> isIntersecting = <span class="literal">true</span>;</div><div class="line"></div><div class="line">	<span class="comment">//X axis</span></div><div class="line">	<span class="keyword">if</span> (t1_minX &gt; t2_maxX)</div><div class="line">	&#123;</div><div class="line">		isIntersecting = <span class="literal">false</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">else</span> <span class="title">if</span> (<span class="params">t2_minX &gt; t1_maxX</span>)</span></div><div class="line">	&#123;</div><div class="line">		isIntersecting = <span class="literal">false</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="comment">//Z axis</span></div><div class="line">	<span class="function"><span class="keyword">else</span> <span class="title">if</span> (<span class="params">t1_minZ &gt; t2_maxZ</span>)</span></div><div class="line">	&#123;</div><div class="line">		isIntersecting = <span class="literal">false</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">else</span> <span class="title">if</span> (<span class="params">t2_minZ &gt; t1_maxZ</span>)</span></div><div class="line">	&#123;</div><div class="line">		isIntersecting = <span class="literal">false</span>;</div><div class="line">	&#125;</div><div class="line"></div><div class="line"></div><div class="line">	<span class="comment">//Debugging to display the approximated rectangles</span></div><div class="line">	<span class="comment">//Box 1</span></div><div class="line">	Vector3 BB_1_centerPos = <span class="keyword">new</span> Vector3((t1_maxX - t1_minX) * <span class="number">0.5</span>f + t1_minX, <span class="number">-0.2</span>f, (t1_maxZ - t1_minZ) * <span class="number">0.5</span>f + t1_minZ);</div><div class="line"></div><div class="line">	box1Obj.transform.position = BB_1_centerPos;</div><div class="line"></div><div class="line">	box1Obj.transform.localScale = <span class="keyword">new</span> Vector3(t1_maxX - t1_minX, <span class="number">0.1</span>f, t1_maxZ - t1_minZ);</div><div class="line"></div><div class="line">	<span class="comment">//Box 2</span></div><div class="line">	Vector3 BB_2_centerPos = <span class="keyword">new</span> Vector3((t2_maxX - t2_minX) * <span class="number">0.5</span>f + t2_minX, <span class="number">-0.2</span>f, (t2_maxZ - t2_minZ) * <span class="number">0.5</span>f + t2_minZ);</div><div class="line"></div><div class="line">	box2Obj.transform.position = BB_2_centerPos;</div><div class="line"></div><div class="line">	box2Obj.transform.localScale = <span class="keyword">new</span> Vector3(t2_maxX - t2_minX, <span class="number">0.1</span>f, t2_maxZ - t2_minZ);</div><div class="line"></div><div class="line"></div><div class="line">	<span class="keyword">return</span> isIntersecting;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>It should look like this in Unity:</p>
<p><img src="https://raw.githubusercontent.com/tospan/tospan.github.io/source/source/_images/unity/aabb-intersection-test.png" alt="Intersection of 2 rectangles with AABB intersection method"></p>
<h2 id="Step-2-Line-line-intersection"><a href="#Step-2-Line-line-intersection" class="headerlink" title="Step 2. Line-line intersection"></a>Step 2. Line-line intersection</h2><p>In the tutorial before this one, the Are two line segments in 2D space intersecting?, we learned how to check if two lines are intersecting. We will use this idea to test if our triangles are intersecting. So we will loop through all sides of one triangle and see if each side intersects with any of the sides of the other triangle. This is how it looks like in code:</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">// Intersection: Line segment - triangle</span></div><div class="line"><span class="comment">//</span></div><div class="line"></div><div class="line"><span class="comment">//Check if any of the edges that make up one of the triangles is intersecting with any of</span></div><div class="line"><span class="comment">//the edges of the other triangle</span></div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">AreAnyLineSegmentsIntersecting</span>(<span class="params">Triangle t1, Triangle t2</span>)</span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">bool</span> isIntersecting = <span class="literal">false</span>;</div><div class="line"></div><div class="line">	<span class="comment">//Loop through all edges</span></div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; t1.lineSegments.Length; i++)</div><div class="line">	&#123;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; t2.lineSegments.Length; j++)</div><div class="line">		&#123;</div><div class="line">			<span class="comment">//The start/end coordinates of the current line segments</span></div><div class="line">			Vector3 t1_p1 = t1.lineSegments[i].p1;</div><div class="line">			Vector3 t1_p2 = t1.lineSegments[i].p2;</div><div class="line">			Vector3 t2_p1 = t2.lineSegments[j].p1;</div><div class="line">			Vector3 t2_p2 = t2.lineSegments[j].p2;</div><div class="line"></div><div class="line">			<span class="comment">//Are they intersecting?</span></div><div class="line">			<span class="keyword">if</span> (AreLineSegmentsIntersecting(t1_p1, t1_p2, t2_p1, t2_p2))</div><div class="line">			&#123;</div><div class="line">				isIntersecting = <span class="literal">true</span>;</div><div class="line"></div><div class="line">				<span class="comment">//To stop the outer for loop</span></div><div class="line">				i = <span class="keyword">int</span>.MaxValue - <span class="number">1</span>;</div><div class="line"></div><div class="line">				<span class="keyword">break</span>;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="keyword">return</span> isIntersecting;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//Check if 2 line segments are intersecting in 2d space</span></div><div class="line"><span class="comment">//http://thirdpartyninjas.com/blog/2008/10/07/line-segment-intersection/</span></div><div class="line"><span class="comment">//p1 and p2 belong to line 1, p3 and p4 belong to line 2</span></div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">AreLineSegmentsIntersecting</span>(<span class="params">Vector3 p1, Vector3 p2, Vector3 p3, Vector3 p4</span>)</span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">bool</span> isIntersecting = <span class="literal">false</span>;</div><div class="line"></div><div class="line">	<span class="keyword">float</span> denominator = (p4.z - p3.z) * (p2.x - p1.x) - (p4.x - p3.x) * (p2.z - p1.z);</div><div class="line"></div><div class="line">	<span class="comment">//Make sure the denominator is != 0, if 0 the lines are parallel</span></div><div class="line">	<span class="keyword">if</span> (denominator != <span class="number">0</span>)</div><div class="line">	&#123;</div><div class="line">		<span class="keyword">float</span> u_a = ((p4.x - p3.x) * (p1.z - p3.z) - (p4.z - p3.z) * (p1.x - p3.x)) / denominator;</div><div class="line">		<span class="keyword">float</span> u_b = ((p2.x - p1.x) * (p1.z - p3.z) - (p2.z - p1.z) * (p1.x - p3.x)) / denominator;</div><div class="line"></div><div class="line">		<span class="comment">//Is intersecting if u_a and u_b are between 0 and 1</span></div><div class="line">		<span class="keyword">if</span> (u_a &gt;= <span class="number">0</span> &amp;&amp; u_a &lt;= <span class="number">1</span> &amp;&amp; u_b &gt;= <span class="number">0</span> &amp;&amp; u_b &lt;= <span class="number">1</span>)</div><div class="line">		&#123;</div><div class="line">			isIntersecting = <span class="literal">true</span>;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="keyword">return</span> isIntersecting;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>It should look like this in Unity:</p>
<p><img src="https://raw.githubusercontent.com/tospan/tospan.github.io/source/source/_images/unity/line-triangle-intersection-test.png" alt="Intersection of a line and a triangle"></p>
<h2 id="Step-3-Point-in-triangle-intersection"><a href="#Step-3-Point-in-triangle-intersection" class="headerlink" title="Step 3. Point in triangle intersection"></a>Step 3. Point in triangle intersection</h2><p>What if one of the triangles is so small that it can be inside of the other triangle? In that case we need to check if one of the corners of each triangle is inside of the other triangle, and vice versa but for the other triangle.</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">// Intersection: Point in triangle</span></div><div class="line"><span class="comment">//</span></div><div class="line"></div><div class="line"><span class="comment">//There's a possibility that one of the triangles is smaller than the other</span></div><div class="line"><span class="comment">//So we have to check if any of the triangle's corners is inside the other triangle</span></div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">AreCornersIntersecting</span>(<span class="params">Triangle t1, Triangle t2</span>)</span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">bool</span> isIntersecting = <span class="literal">false</span>;</div><div class="line"></div><div class="line">	<span class="comment">//We only have to test one corner from each triangle</span></div><div class="line">	<span class="comment">//Triangle 1 in triangle 2</span></div><div class="line">	<span class="keyword">if</span> (IsPointInTriangle(t1.p1, t2.p1, t2.p2, t2.p3))</div><div class="line">	&#123;</div><div class="line">		isIntersecting = <span class="literal">true</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="comment">//Triangle 2 in triangle 1</span></div><div class="line">	<span class="function"><span class="keyword">else</span> <span class="title">if</span> (<span class="params">IsPointInTriangle(t2.p1, t1.p1, t1.p2, t1.p3</span>))</span></div><div class="line">	&#123;</div><div class="line">		isIntersecting = <span class="literal">true</span>;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="keyword">return</span> isIntersecting;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">//Is a point p inside a triangle p1-p2-p3?</span></div><div class="line"><span class="comment">//From http://totologic.blogspot.se/2014/01/accurate-point-in-triangle-test.html</span></div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">IsPointInTriangle</span>(<span class="params">Vector3 p, Vector3 p1, Vector3 p2, Vector3 p3</span>)</span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">bool</span> isWithinTriangle = <span class="literal">false</span>;</div><div class="line"></div><div class="line">	<span class="keyword">float</span> denominator = ((p2.z - p3.z) * (p1.x - p3.x) + (p3.x - p2.x) * (p1.z - p3.z));</div><div class="line"></div><div class="line">	<span class="keyword">float</span> a = ((p2.z - p3.z) * (p.x - p3.x) + (p3.x - p2.x) * (p.z - p3.z)) / denominator;</div><div class="line">	<span class="keyword">float</span> b = ((p3.z - p1.z) * (p.x - p3.x) + (p1.x - p3.x) * (p.z - p3.z)) / denominator;</div><div class="line">	<span class="keyword">float</span> c = <span class="number">1</span> - a - b;</div><div class="line"></div><div class="line">	<span class="comment">//The point is within the triangle if 0 &lt;= a &lt;= 1 and 0 &lt;= b &lt;= 1 and 0 &lt;= c &lt;= 1</span></div><div class="line">	<span class="keyword">if</span> (a &gt;= <span class="number">0</span>f &amp;&amp; a &lt;= <span class="number">1</span>f &amp;&amp; b &gt;= <span class="number">0</span>f &amp;&amp; b &lt;= <span class="number">1</span>f &amp;&amp; c &gt;= <span class="number">0</span>f &amp;&amp; c &lt;= <span class="number">1</span>f)</div><div class="line">	&#123;</div><div class="line">		isWithinTriangle = <span class="literal">true</span>;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="keyword">return</span> isWithinTriangle;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>It should look like this in Unity:</p>
<p><img src="https://raw.githubusercontent.com/tospan/tospan.github.io/source/source/_images/unity/line-triangle-intersection-test.png" alt="Intersection of a point in a triangle"><br>That’s it!</p>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul>
<li><a href="http://www.habrador.com/tutorials/linear-algebra/6-triangle-triangle-intersection/" target="_blank" rel="external">Are two triangles in 2D space intersecting?</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://tospan.me/2017/02/05/Unity/Are-two-triangles-in-2D-space-intersecting/" data-id="cizhoremz002g1gvwzefde178" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linear-Algebra/">Linear Algebra</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Math/">Math</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Unity/">Unity</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2017/02/05/Unity/Are-two-rectangles-with-orientation-in-2D-space-intersecting/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Are two rectangles with orientation in 2D space intersecting
        
      </div>
    </a>
  
  
    <a href="/2017/02/05/Unity/Are-two-line-segments-in-2D-space-intersecting/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Are two line segments in 2D space intersecting</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Algorithms/">Algorithms</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Game-Development/">Game Development</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Game-Programming-Patterns/">Game Programming Patterns</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Unity/">Unity</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Unity-Tutorials/">Unity Tutorials</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/default/">default</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Algorithms/">Algorithms</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Basics/">Basics</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/C/">C#</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Data-Structure/">Data Structure</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Games/">Games</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Geometry/">Geometry</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linear-Algebra/">Linear Algebra</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Math/">Math</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mathematics/">Mathematics</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Numerical-Analysis/">Numerical Analysis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Patterns/">Patterns</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Scripting/">Scripting</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Unity/">Unity</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/default/">default</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Algorithms/" style="font-size: 17.5px;">Algorithms</a> <a href="/tags/Basics/" style="font-size: 12.5px;">Basics</a> <a href="/tags/C/" style="font-size: 12.5px;">C#</a> <a href="/tags/Data-Structure/" style="font-size: 16.25px;">Data Structure</a> <a href="/tags/Games/" style="font-size: 10px;">Games</a> <a href="/tags/Geometry/" style="font-size: 11.25px;">Geometry</a> <a href="/tags/Linear-Algebra/" style="font-size: 13.75px;">Linear Algebra</a> <a href="/tags/Math/" style="font-size: 12.5px;">Math</a> <a href="/tags/Mathematics/" style="font-size: 12.5px;">Mathematics</a> <a href="/tags/Numerical-Analysis/" style="font-size: 10px;">Numerical Analysis</a> <a href="/tags/Patterns/" style="font-size: 15px;">Patterns</a> <a href="/tags/Scripting/" style="font-size: 18.75px;">Scripting</a> <a href="/tags/Unity/" style="font-size: 20px;">Unity</a> <a href="/tags/default/" style="font-size: 11.25px;">default</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">February 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">January 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/09/">September 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/08/">August 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/05/">May 2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/04/">April 2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/03/">March 2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/02/">February 2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/01/">January 2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/12/">December 2012</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2017/02/23/Unity-Multiplayer-And-Networking/">Unity Multiplayer And Networking</a>
          </li>
        
          <li>
            <a href="/2017/02/23/Unity-Physics/">Unity Physics</a>
          </li>
        
          <li>
            <a href="/2017/02/10/Game-Development/">游戏开发</a>
          </li>
        
          <li>
            <a href="/2017/02/08/Unity/Scripting-Quick-Benchmark/">Unity 简单基准测试</a>
          </li>
        
          <li>
            <a href="/2017/02/07/Unity/Patterns-FSM/">游戏编程设计模式:有限状态机(FSM)</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 To Span<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</body>
</html>