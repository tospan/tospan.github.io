<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Are two line segments in 2D space intersecting | 吐司片的博客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="You have two line segments and want to know if they are crossing each other:">
<meta property="og:type" content="article">
<meta property="og:title" content="Are two line segments in 2D space intersecting">
<meta property="og:url" content="http://tospan.me/2017/02/05/Are-two-line-segments-in-2D-space-intersecting/index.html">
<meta property="og:site_name" content="吐司片的博客">
<meta property="og:description" content="You have two line segments and want to know if they are crossing each other:">
<meta property="og:image" content="https://raw.githubusercontent.com/tospan/tospan.github.io/source/source/_images/unity/no-intersection.png">
<meta property="og:image" content="https://raw.githubusercontent.com/tospan/tospan.github.io/source/source/_images/unity/intersection.png">
<meta property="og:image" content="https://raw.githubusercontent.com/tospan/tospan.github.io/source/source/_images/unity/dot-product-line-intersection.png">
<meta property="og:updated_time" content="2017-02-06T13:18:11.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Are two line segments in 2D space intersecting">
<meta name="twitter:description" content="You have two line segments and want to know if they are crossing each other:">
<meta name="twitter:image" content="https://raw.githubusercontent.com/tospan/tospan.github.io/source/source/_images/unity/no-intersection.png">
  
    <link rel="alternate" href="/atom.xml" title="吐司片的博客" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">吐司片的博客</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">Work hard, play hard.</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://tospan.me"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-Are-two-line-segments-in-2D-space-intersecting" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/02/05/Are-two-line-segments-in-2D-space-intersecting/" class="article-date">
  <time datetime="2017-02-05T02:11:27.000Z" itemprop="datePublished">2017-02-05</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Unity/">Unity</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Are two line segments in 2D space intersecting
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>You have two line segments and want to know if they are crossing each other:</p>
<p><img src="https://raw.githubusercontent.com/tospan/tospan.github.io/source/source/_images/unity/no-intersection.png" alt="No intersection between line segments"></p>
<a id="more"></a>
<p><img src="https://raw.githubusercontent.com/tospan/tospan.github.io/source/source/_images/unity/intersection.png" alt="Intersection between line segments"></p>
<p>This is more complicated than it seems, but you can probably ignore some steps depending on which application you are making. For example, it’s often unnecessary to test if the line segments are parallel if you are making a game, because the probability that they are exactly parallel is low.</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">using</span> UnityEngine;</div><div class="line"><span class="keyword">using</span> System.Collections;</div><div class="line"></div><div class="line"><span class="keyword">namespace</span> <span class="title">LinearAlgebra</span></div><div class="line">&#123;</div><div class="line">    <span class="comment">//How to figure out if two lines are intersecting</span></div><div class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">LineLineIntersection</span> : <span class="title">MonoBehaviour</span></div><div class="line">    &#123;</div><div class="line">        <span class="comment">//The start end of each line</span></div><div class="line">        <span class="keyword">public</span> Transform L1_start;</div><div class="line">        <span class="keyword">public</span> Transform L1_end;</div><div class="line">        <span class="keyword">public</span> Transform L2_start;</div><div class="line">        <span class="keyword">public</span> Transform L2_end;</div><div class="line"></div><div class="line">        <span class="comment">//Just attach a line renderer to an empty game object</span></div><div class="line">        <span class="keyword">public</span> LineRenderer lineRenderer1;</div><div class="line">        <span class="keyword">public</span> LineRenderer lineRenderer2;</div><div class="line"></div><div class="line">        <span class="function"><span class="keyword">void</span> <span class="title">Start</span>(<span class="params"></span>)</span></div><div class="line">        &#123;</div><div class="line">            <span class="comment">//Give the line renderer a material so we can change the color if they intersect</span></div><div class="line">            lineRenderer1.material = <span class="keyword">new</span> Material(Shader.Find(<span class="string">"Unlit/Color"</span>));</div><div class="line">            lineRenderer2.material = <span class="keyword">new</span> Material(Shader.Find(<span class="string">"Unlit/Color"</span>));</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="function"><span class="keyword">void</span> <span class="title">Update</span>(<span class="params"></span>)</span></div><div class="line">        &#123;</div><div class="line">            <span class="comment">//Connect the points with line renderers</span></div><div class="line">            lineRenderer1.SetPosition(<span class="number">0</span>, L1_start.position);</div><div class="line">            lineRenderer1.SetPosition(<span class="number">1</span>, L1_end.position);</div><div class="line"></div><div class="line">            lineRenderer2.SetPosition(<span class="number">0</span>, L2_start.position);</div><div class="line">            lineRenderer2.SetPosition(<span class="number">1</span>, L2_end.position);</div><div class="line"></div><div class="line">            <span class="comment">//Set the default color</span></div><div class="line">            lineRenderer1.material.color = Color.red;</div><div class="line">            lineRenderer2.material.color = Color.red;</div><div class="line"></div><div class="line">            <span class="comment">//Change color if they intersect</span></div><div class="line">            <span class="keyword">if</span> (IsIntersecting())</div><div class="line">            &#123;</div><div class="line">                lineRenderer1.material.color = Color.blue;</div><div class="line">                lineRenderer2.material.color = Color.blue;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="comment">//Check if the lines are interesecting in 2d space</span></div><div class="line">        <span class="function"><span class="keyword">bool</span> <span class="title">IsIntersecting</span>(<span class="params"></span>)</span></div><div class="line">        &#123;</div><div class="line">            <span class="keyword">bool</span> isIntersecting = <span class="literal">false</span>;</div><div class="line"></div><div class="line">            <span class="comment">//3d -&gt; 2d</span></div><div class="line">            Vector2 l1_start = <span class="keyword">new</span> Vector2(L1_start.position.x, L1_start.position.z);</div><div class="line">            Vector2 l1_end = <span class="keyword">new</span> Vector2(L1_end.position.x, L1_end.position.z);</div><div class="line"></div><div class="line">            Vector2 l2_start = <span class="keyword">new</span> Vector2(L2_start.position.x, L2_start.position.z);</div><div class="line">            Vector2 l2_end = <span class="keyword">new</span> Vector2(L2_end.position.x, L2_end.position.z);</div><div class="line"></div><div class="line">            <span class="comment">//Direction of the lines</span></div><div class="line">            Vector2 l1_dir = (l1_end - l1_start).normalized;</div><div class="line">            Vector2 l2_dir = (l2_end - l2_start).normalized;</div><div class="line"></div><div class="line">            <span class="comment">//If we know the direction we can get the normal vector to each line</span></div><div class="line">            Vector2 l1_normal = <span class="keyword">new</span> Vector2(-l1_dir.y, l1_dir.x);</div><div class="line">            Vector2 l2_normal = <span class="keyword">new</span> Vector2(-l2_dir.y, l2_dir.x);</div><div class="line"></div><div class="line"></div><div class="line">            <span class="comment">//Step 1: Rewrite the lines to a general form: Ax + By = k1 and Cx + Dy = k2</span></div><div class="line">            <span class="comment">//The normal vector is the A, B</span></div><div class="line">            <span class="keyword">float</span> A = l1_normal.x;</div><div class="line">            <span class="keyword">float</span> B = l1_normal.y;</div><div class="line"></div><div class="line">            <span class="keyword">float</span> C = l2_normal.x;</div><div class="line">            <span class="keyword">float</span> D = l2_normal.y;</div><div class="line"></div><div class="line">            <span class="comment">//To get k we just use one point on the line</span></div><div class="line">            <span class="keyword">float</span> k1 = (A * l1_start.x) + (B * l1_start.y);</div><div class="line">            <span class="keyword">float</span> k2 = (C * l2_start.x) + (D * l2_start.y);</div><div class="line"></div><div class="line"></div><div class="line">            <span class="comment">//Step 2: are the lines parallel? -&gt; no solutions</span></div><div class="line">            <span class="keyword">if</span> (IsParallel(l1_normal, l2_normal))</div><div class="line">            &#123;</div><div class="line">                Debug.Log(<span class="string">"The lines are parallel so no solutions!"</span>);</div><div class="line"></div><div class="line">                <span class="keyword">return</span> isIntersecting;</div><div class="line">            &#125;</div><div class="line"></div><div class="line"></div><div class="line">            <span class="comment">//Step 3: are the lines the same line? -&gt; infinite amount of solutions</span></div><div class="line">            <span class="comment">//Pick one point on each line and test if the vector between the points is orthogonal to one of the normals</span></div><div class="line">            <span class="keyword">if</span> (IsOrthogonal(l1_start - l2_start, l1_normal))</div><div class="line">            &#123;</div><div class="line">                Debug.Log(<span class="string">"Same line so infinite amount of solutions!"</span>);</div><div class="line"></div><div class="line">                <span class="comment">//Return false anyway</span></div><div class="line">                <span class="keyword">return</span> isIntersecting;</div><div class="line">            &#125;</div><div class="line"></div><div class="line"></div><div class="line">            <span class="comment">//Step 4: calculate the intersection point -&gt; one solution</span></div><div class="line">            <span class="keyword">float</span> x_intersect = (D * k1 - B * k2) / (A * D - B * C);</div><div class="line">            <span class="keyword">float</span> y_intersect = (-C * k1 + A * k2) / (A * D - B * C);</div><div class="line"></div><div class="line">            Vector2 intersectPoint = <span class="keyword">new</span> Vector2(x_intersect, y_intersect); </div><div class="line"></div><div class="line"></div><div class="line">            <span class="comment">//Step 5: but we have line segments so we have to check if the intersection point is within the segment</span></div><div class="line">            <span class="keyword">if</span> (IsBetween(l1_start, l1_end, intersectPoint) &amp;&amp; IsBetween(l2_start, l2_end, intersectPoint))</div><div class="line">            &#123;</div><div class="line">                Debug.Log(<span class="string">"We have an intersection point!"</span>);</div><div class="line"></div><div class="line">                isIntersecting = <span class="literal">true</span>;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            <span class="keyword">return</span> isIntersecting;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="comment">//Are 2 vectors parallel?</span></div><div class="line">        <span class="function"><span class="keyword">bool</span> <span class="title">IsParallel</span>(<span class="params">Vector2 v1, Vector2 v2</span>)</span></div><div class="line">        &#123;</div><div class="line">            <span class="comment">//2 vectors are parallel if the angle between the vectors are 0 or 180 degrees</span></div><div class="line">            <span class="keyword">if</span> (Vector2.Angle(v1, v2) == <span class="number">0</span>f || Vector2.Angle(v1, v2) == <span class="number">180</span>f)</div><div class="line">            &#123;</div><div class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="comment">//Are 2 vectors orthogonal?</span></div><div class="line">        <span class="function"><span class="keyword">bool</span> <span class="title">IsOrthogonal</span>(<span class="params">Vector2 v1, Vector2 v2</span>)</span></div><div class="line">        &#123;</div><div class="line">            <span class="comment">//2 vectors are orthogonal is the dot product is 0</span></div><div class="line">            <span class="comment">//We have to check if close to 0 because of floating numbers</span></div><div class="line">            <span class="keyword">if</span> (Mathf.Abs(Vector2.Dot(v1, v2)) &lt; <span class="number">0.000001</span>f)</div><div class="line">            &#123;</div><div class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="comment">//Is a point c between 2 other points a and b?</span></div><div class="line">        <span class="function"><span class="keyword">bool</span> <span class="title">IsBetween</span>(<span class="params">Vector2 a, Vector2 b, Vector2 c</span>)</span></div><div class="line">        &#123;</div><div class="line">            <span class="keyword">bool</span> isBetween = <span class="literal">false</span>;</div><div class="line"></div><div class="line">            <span class="comment">//Entire line segment</span></div><div class="line">            Vector2 ab = b - a;</div><div class="line">            <span class="comment">//The intersection and the first point</span></div><div class="line">            Vector2 ac = c - a;</div><div class="line"></div><div class="line">            <span class="comment">//Need to check 2 things: </span></div><div class="line">            <span class="comment">//1. If the vectors are pointing in the same direction = if the dot product is positive</span></div><div class="line">            <span class="comment">//2. If the length of the vector between the intersection and the first point is smaller than the entire line</span></div><div class="line">            <span class="keyword">if</span> (Vector2.Dot(ab, ac) &gt; <span class="number">0</span>f &amp;&amp; ab.sqrMagnitude &gt;= ac.sqrMagnitude)</div><div class="line">            &#123;</div><div class="line">                isBetween = <span class="literal">true</span>;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            <span class="keyword">return</span> isBetween;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Light-version-1"><a href="#Light-version-1" class="headerlink" title="Light version 1"></a>Light version 1</h2><p>The above version is more robust and will even work in more dimensions, but if speed is the key and you are working in 2d space, I’ve found another solution here. So you can replace the fat version with this:</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//Check if the lines are interescting in 2d space</span></div><div class="line"><span class="comment">//Alternative version from http://thirdpartyninjas.com/blog/2008/10/07/line-segment-intersection/</span></div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">IsIntersectingAlternative</span>(<span class="params"></span>)</span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">bool</span> isIntersecting = <span class="literal">false</span>;</div><div class="line"></div><div class="line">	<span class="comment">//3d -&gt; 2d</span></div><div class="line">	Vector2 p1 = <span class="keyword">new</span> Vector2(L1_start.position.x, L1_start.position.z);</div><div class="line">	Vector2 p2 = <span class="keyword">new</span> Vector2(L1_end.position.x, L1_end.position.z);</div><div class="line"></div><div class="line">	Vector2 p3 = <span class="keyword">new</span> Vector2(L2_start.position.x, L2_start.position.z);</div><div class="line">	Vector2 p4 = <span class="keyword">new</span> Vector2(L2_end.position.x, L2_end.position.z);</div><div class="line"></div><div class="line">	<span class="keyword">float</span> denominator = (p4.y - p3.y) * (p2.x - p1.x) - (p4.x - p3.x) * (p2.y - p1.y);</div><div class="line">	</div><div class="line">	<span class="comment">//Make sure the denominator is &gt; 0, if so the lines are parallel</span></div><div class="line">	<span class="keyword">if</span> (denominator != <span class="number">0</span>)</div><div class="line">	&#123;</div><div class="line">		<span class="keyword">float</span> u_a = ((p4.x - p3.x) * (p1.y - p3.y) - (p4.y - p3.y) * (p1.x - p3.x)) / denominator;</div><div class="line">		<span class="keyword">float</span> u_b = ((p2.x - p1.x) * (p1.y - p3.y) - (p2.y - p1.y) * (p1.x - p3.x)) / denominator;</div><div class="line"></div><div class="line">		<span class="comment">//Is intersecting if u_a and u_b are between 0 and 1</span></div><div class="line">		<span class="keyword">if</span> (u_a &gt;= <span class="number">0</span> &amp;&amp; u_a &lt;= <span class="number">1</span> &amp;&amp; u_b &gt;= <span class="number">0</span> &amp;&amp; u_b &lt;= <span class="number">1</span>)</div><div class="line">		&#123;</div><div class="line">			isIntersecting = <span class="literal">true</span>;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="keyword">return</span> isIntersecting;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Light-version-2"><a href="#Light-version-2" class="headerlink" title="Light version 2"></a>Light version 2</h2><p>There’s actually a third way to figure out if two line segments in 2d space are intersecting. The problem with this way is that you can’t find the point of intersection, but that doesn’t matter if you don’t need to. To help us we are going to use the dot product! The basic idea is this (we want to see if the blue line and the black line is intersecting):</p>
<p><img src="https://raw.githubusercontent.com/tospan/tospan.github.io/source/source/_images/unity/dot-product-line-intersection.png" alt="Intersection between line segments by using the dot product"></p>
<p>We first have to find the normal to a line. Then we calculate the dot product between this normal and the direction between the normal and the two points on the other line. If one of these dot products is negative and the other is positive, then we know the points on the other line are on different sides of the first line. Then we repeat the process for the other line. If you want a more detailed explanation you should watch this video: TypeScript Game Development - Basic 2D Collision Detection. The code looks like this:</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//Line segment-line segment intersection in 2d space by using the dot product</span></div><div class="line"><span class="comment">//p1 and p2 belongs to line 1, and p3 and p4 belongs to line 2 </span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">bool</span> <span class="title">AreLineSegmentsIntersectingDotProduct</span>(<span class="params">Vector3 p1, Vector3 p2, Vector3 p3, Vector3 p4</span>)</span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">bool</span> isIntersecting = <span class="literal">false</span>;</div><div class="line"></div><div class="line">	<span class="keyword">if</span> (IsPointsOnDifferentSides(p1, p2, p3, p4) &amp;&amp; IsPointsOnDifferentSides(p3, p4, p1, p2))</div><div class="line">	&#123;</div><div class="line">		isIntersecting = <span class="literal">true</span>;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="keyword">return</span> isIntersecting;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//Are the points on different sides of a line?</span></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">bool</span> <span class="title">IsPointsOnDifferentSides</span>(<span class="params">Vector3 p1, Vector3 p2, Vector3 p3, Vector3 p4</span>)</span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">bool</span> isOnDifferentSides = <span class="literal">false</span>;</div><div class="line">	</div><div class="line">	<span class="comment">//The direction of the line</span></div><div class="line">	Vector3 lineDir = p2 - p1;</div><div class="line"></div><div class="line">	<span class="comment">//The normal to a line is just flipping x and z and making z negative</span></div><div class="line">	Vector3 lineNormal = <span class="keyword">new</span> Vector3(-lineDir.z, lineDir.y, lineDir.x);</div><div class="line">	</div><div class="line">	<span class="comment">//Now we need to take the dot product between the normal and the points on the other line</span></div><div class="line">	<span class="keyword">float</span> dot1 = Vector3.Dot(lineNormal, p3 - p1);</div><div class="line">	<span class="keyword">float</span> dot2 = Vector3.Dot(lineNormal, p4 - p1);</div><div class="line"></div><div class="line">	<span class="comment">//If you multiply them and get a negative value then p3 and p4 are on different sides of the line</span></div><div class="line">	<span class="keyword">if</span> (dot1 * dot2 &lt; <span class="number">0</span>f)</div><div class="line">	&#123;</div><div class="line">		isOnDifferentSides = <span class="literal">true</span>;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="keyword">return</span> isOnDifferentSides;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h2><p>So which one is the fastest? I’ve used C#’s stopwatch timer to measure the time of each line segment-line segment algorithm, and after 1000 updates, this was the total time:</p>
<p>Algorithm 1: 06.9025942 seconds<br>Algorithm 2: 00.0034113 seconds<br>Algorithm 3: 00.0096906 seconds</p>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul>
<li><a href="http://www.habrador.com/tutorials/linear-algebra/5-line-line-intersection/" target="_blank" rel="external">Are two line segments in 2D space intersecting?</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://tospan.me/2017/02/05/Are-two-line-segments-in-2D-space-intersecting/" data-id="ciyu4ntdb00002tvwqgprkq4g" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linear-Algebra/">Linear Algebra</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Math/">Math</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Unity/">Unity</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2017/02/05/Are-two-triangles-in-2D-space-intersecting/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Are two triangles in 2D space intersecting
        
      </div>
    </a>
  
  
    <a href="/2017/02/05/Find-the-coordinate-where-a-ray-intersects-with-a-plane/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Find the coordinate where a ray intersects with a plane</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Math/">Math</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Unity/">Unity</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Basics/">Basics</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/C/">C#</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Games/">Games</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Geometry/">Geometry</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linear-Algebra/">Linear Algebra</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Math/">Math</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Numerical-Analysis/">Numerical Analysis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Unity/">Unity</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/default/">default</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Basics/" style="font-size: 15px;">Basics</a> <a href="/tags/C/" style="font-size: 13.33px;">C#</a> <a href="/tags/Games/" style="font-size: 10px;">Games</a> <a href="/tags/Geometry/" style="font-size: 11.67px;">Geometry</a> <a href="/tags/Linear-Algebra/" style="font-size: 16.67px;">Linear Algebra</a> <a href="/tags/Math/" style="font-size: 18.33px;">Math</a> <a href="/tags/Numerical-Analysis/" style="font-size: 10px;">Numerical Analysis</a> <a href="/tags/Unity/" style="font-size: 20px;">Unity</a> <a href="/tags/default/" style="font-size: 10px;">default</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">February 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">January 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/12/">December 2012</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2017/02/06/Math-3D/">3D数学</a>
          </li>
        
          <li>
            <a href="/2017/02/06/Unity-Engine-Core-Concept/">Unity引擎重要概念</a>
          </li>
        
          <li>
            <a href="/2017/02/06/Unity-Scripting-2D-Code-Snippet/">Unity编程 2D脚本常用代码集合</a>
          </li>
        
          <li>
            <a href="/2017/02/06/Unity-Scripting-Core/">Unity编程要点</a>
          </li>
        
          <li>
            <a href="/2017/02/06/C-Sharp-Essential/">C#要点</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 To Span<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>