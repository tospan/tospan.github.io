<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>在Unity中制作Dubins曲线(C#) | 吐司片的博客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="IntroductionIn this tutorial you will learn how to make Dubins paths in Unity with C# code. This is how Wikipedia defines Dubins paths:

In geometry, the term Dubins path typically refers to the short">
<meta property="og:type" content="article">
<meta property="og:title" content="在Unity中制作Dubins曲线(C#)">
<meta property="og:url" content="http://tospan.me/2017/02/05/How-to-make-Dubins-Paths-in-Unity/index.html">
<meta property="og:site_name" content="吐司片的博客">
<meta property="og:description" content="IntroductionIn this tutorial you will learn how to make Dubins paths in Unity with C# code. This is how Wikipedia defines Dubins paths:

In geometry, the term Dubins path typically refers to the short">
<meta property="og:image" content="https://raw.githubusercontent.com/tospan/tospan.github.io/source/source/_images/unity/dubins-paths-self-driving-car.png">
<meta property="og:image" content="https://raw.githubusercontent.com/tospan/tospan.github.io/source/source/_images/unity/left-right-circles-with-angles.png">
<meta property="og:image" content="https://raw.githubusercontent.com/tospan/tospan.github.io/source/source/_images/unity/outer-inner-tangent-lines.png">
<meta property="og:image" content="https://raw.githubusercontent.com/tospan/tospan.github.io/source/source/_images/unity/RSR.png">
<meta property="og:image" content="https://raw.githubusercontent.com/tospan/tospan.github.io/source/source/_images/unity/RSR-or-LSL.png">
<meta property="og:image" content="https://raw.githubusercontent.com/tospan/tospan.github.io/source/source/_images/unity/LSR-or-RSL.png">
<meta property="og:image" content="https://raw.githubusercontent.com/tospan/tospan.github.io/source/source/_images/unity/RLR-or-LRL.png">
<meta property="og:image" content="https://raw.githubusercontent.com/tospan/tospan.github.io/source/source/_images/unity/dubins-paths-tesla.png">
<meta property="og:image" content="https://raw.githubusercontent.com/tospan/tospan.github.io/source/source/_images/unity/start-scene.png">
<meta property="og:image" content="https://raw.githubusercontent.com/tospan/tospan.github.io/source/source/_images/unity/dubins-paths-final.png">
<meta property="og:updated_time" content="2017-02-06T13:18:11.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="在Unity中制作Dubins曲线(C#)">
<meta name="twitter:description" content="IntroductionIn this tutorial you will learn how to make Dubins paths in Unity with C# code. This is how Wikipedia defines Dubins paths:

In geometry, the term Dubins path typically refers to the short">
<meta name="twitter:image" content="https://raw.githubusercontent.com/tospan/tospan.github.io/source/source/_images/unity/dubins-paths-self-driving-car.png">
  
    <link rel="alternate" href="/atom.xml" title="吐司片的博客" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">吐司片的博客</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">Work hard, play hard.</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://tospan.me"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-How-to-make-Dubins-Paths-in-Unity" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/02/05/How-to-make-Dubins-Paths-in-Unity/" class="article-date">
  <time datetime="2017-02-05T03:18:41.000Z" itemprop="datePublished">2017-02-05</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Unity/">Unity</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      在Unity中制作Dubins曲线(C#)
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>In this tutorial you will learn how to make Dubins paths in Unity with C# code. This is how <a href="https://en.wikipedia.org/wiki/Dubins_path" target="_blank" rel="external">Wikipedia</a> defines Dubins paths:</p>
<blockquote>
<p>In geometry, the term Dubins path typically refers to the shortest curve that connects two points in the two-dimensional Euclidean plane (i.e. x-y plane) with a constraint on the curvature of the path and with prescribed initial and terminal tangents to the path, and an assumption that the vehicle traveling the path can only travel forward. If the vehicle can also travel in reverse, then the path follows the Reeds-Shepp curve.</p>
</blockquote>
<a id="more"></a>
<p>But why would anyone need a Dubins path? One application is self-driving cars. I’ve made a self-driving car in Unity and I used Dubins paths to improve the pathfinding algorithm Hybrid A<em>. The problem with Hybrid A</em> is that Hybrid A* doesn’t care about the final orientation of the car, which is what Dubins paths care about. This is how it looks like:</p>
<p><img src="https://raw.githubusercontent.com/tospan/tospan.github.io/source/source/_images/unity/dubins-paths-self-driving-car.png" alt="Self driving car using Dubins paths"></p>
<p>The white line is the shortest Dubins path and the gray line is a modified Dubins path because it can also reverse. As the Wikipedia article said, you can modify the Dubins paths and you will end up with the so-called Reeds–Shepp curves. But we will here focus on the original Dubins paths, which can only drive forward.</p>
<h2 id="Basic-Dubins-Paths"><a href="#Basic-Dubins-Paths" class="headerlink" title="Basic Dubins Paths"></a>Basic Dubins Paths</h2><p>This will be a super short introduction to Dubins paths. Other people have written longer descriptions of Dubins paths, so if you want to read more you should maybe read this: <a href="https://gieseanw.wordpress.com/2012/10/21/a-comprehensive-step-by-step-tutorial-to-computing-dubins-paths/" target="_blank" rel="external">A Comprehensive, Step-by-Step Tutorial to Computing Dubins Paths</a>.</p>
<p>So how do we calculate Dubins paths? Let’s repeat the definition from Wikipedia:</p>
<blockquote>
<p>In geometry, the term Dubins path typically refers to the shortest curve that connects two points in the two-dimensional Euclidean plane (i.e. x-y plane) with a constraint on the curvature of the path and with prescribed initial and terminal tangents to the path, and an assumption that the vehicle traveling the path can only travel forward. If the vehicle can also travel in reverse, then the path follows the Reeds-Shepp curve.</p>
</blockquote>
<p>So the car can only drive forward with constant speed. According to the inventor of Dubins paths, Lester Dubins, there are a maximum of 6 paths you need to calculate to find the shortest distance from A to B if you are a car driving forward with constant speed. Depending on the position of the car and the target we want to reach, there may be fewer than 6 paths.</p>
<p>The 6 paths are described by the following path segments: drive Right, drive Left, and drive Straight. So we end up with the following combinations: RSR, LSL, RSL, LSR, LRL, RLR.</p>
<p>To be able to construct these 6 paths we first have to add 4 circles: 1 circle 90 degrees to the right of the car, 1 circle 90 degrees to the left of the car, 1 circle 90 degrees to the right of the target car, and 1 circle 90 degrees to the left of the target car. It will look like this:</p>
<p><img src="https://raw.githubusercontent.com/tospan/tospan.github.io/source/source/_images/unity/left-right-circles-with-angles.png" alt="Dubins path circles perpendicular to the cars"></p>
<p>Now we need to connect these circles with so-called tangent lines. A tangent line to a circle is perpendicular to the center of the circle. There are 2 different groups of tangent lines: Outer tangent and Inner tangent. The difference is that the inner tangent lines cross the center line that connects the center points of the circles.</p>
<p><img src="https://raw.githubusercontent.com/tospan/tospan.github.io/source/source/_images/unity/outer-inner-tangent-lines.png" alt="Outer and inner tangent lines to circles"></p>
<p>Now we can group the 6 paths into 3 different groups, and each group needs a different calculation. RSR and LSL will always use an outer tangent line, RSL and LSR will always use an inner tangent line, and LRL and RLR will not have a tangent line at all, but 2 tangent coordinates that connects with a third circle.</p>
<p>One good thing that will make things less complicated is that each path will always have the same tangent line. For example, RSR will always use the upper outer tangent line, no matter the orientation of the car and the target:</p>
<p><img src="https://raw.githubusercontent.com/tospan/tospan.github.io/source/source/_images/unity/RSR.png" alt="RSR will always use the upper outer tangent"></p>
<p>So let’s learn how to calculate the tangent lines and coordinates.</p>
<h3 id="Outer-tangent-lines"><a href="#Outer-tangent-lines" class="headerlink" title="Outer tangent lines"></a>Outer tangent lines</h3><p>Calculating the outer tangent lines are easy if the circles have the same radius. This is what we have:</p>
<p><img src="https://raw.githubusercontent.com/tospan/tospan.github.io/source/source/_images/unity/RSR-or-LSL.png" alt="Calculation of outer tangent lines"></p>
<p>What we have is the center coordinates of the both circles, and we want to figure out coordinate B and C. We begin with B. The angle theta is always 90 degrees if the circles have the same radius. But if the circles are not in line (are not at the same “height”) we also have to calculate the angle atan2 to compensate for the rotation.</p>
<p>When we have the angle theta (and modified it with atan2), we can calculate the first tangent coordinate B like this: Bx = Ax + R <em> cos theta and By = Ay + R </em> sin theta.</p>
<p>To get the other tangent point C, we can use the fact that the center line between the circles have the same direction and length as the tangent line. This vector is D-A, and then we just add this vector to the coordinate B to get the second tangent point C.</p>
<p>To get the bottom tangent line, we just repeat the above calculations, but we add pi to the angle theta. The reason is that the bottom tangent is on the opposite side of the upper tangent line, and pi radians is the same as 180 degrees. So now we can find the tangent coordinates belonging to RSR (top tangent line) and LSL (bottom tangent line)!</p>
<h3 id="Inner-tangent-lines"><a href="#Inner-tangent-lines" class="headerlink" title="Inner tangent lines"></a>Inner tangent lines</h3><p>Alright, 2 paths down, 4 to go. Now we will figure out how to calculate the tangent lines belonging to LSR and RSL, which are the inner tangents. This is what we have:</p>
<p><img src="https://raw.githubusercontent.com/tospan/tospan.github.io/source/source/_images/unity/LSR-or-RSL.png" alt="Calculation of inner tangent lines"></p>
<p>We are interested in finding the coordinates B and E. We have the coordinates A and D (center coordinates of each circle) as well as the circle radius R.</p>
<p>With the help of the center coordinates of each circle we can calculate the distance between the circles, which we call D. If we know the distance between A and D and the radius of the circle, we can calculate theta with cosine: theta = acos(2R / D). And as when we calculate the outer tangents, we have to compensate for the fact that the circles don’t have the same position by calculating the angle atan2.</p>
<p>Now (as with the outer tangent lines) we can calculate the first tangent point B. But the difference now is that we can’t calculate the direction of the tangent by just using the vector between the center of the circles. So to get the direction of the tangent we also have to calculate coordinate C by using the same math as when we calculated B, but instead of R we use 2R.</p>
<p>The line CD and the tangent line BE have the same direction, and since we now know both C and D we can calculate the direction as we did with the outer tangent line. Then we just add the direction to B to get the final tangent coordinate E.</p>
<p>Now we know the tangent line RSL (from the top of the right start circle to the bottom of the left goal circle) and LSR (bottom-to-top tangent).</p>
<h3 id="LRL-and-RLR-tangent-coordinates"><a href="#LRL-and-RLR-tangent-coordinates" class="headerlink" title="LRL and RLR tangent coordinates"></a>LRL and RLR tangent coordinates</h3><p>The last path curves are a little special, because now we have to add a third circle with the same size as the other two circles. It looks like this:</p>
<p><img src="https://raw.githubusercontent.com/tospan/tospan.github.io/source/source/_images/unity/RLR-or-LRL.png" alt="Calculation of RLR and LRL tangent coordinates"></p>
<p>As before we have the center position of each circle: A and B. We also have the circle radius R. We are interested in the coordinates D and E.</p>
<p>As you might think, we first have to calculate the angle theta. To get theta we have to use the law of cosines. And if D is the distance between the center position of the circles (not to be confused with tangent coordinate D), the law of cosines becomes: cos theta = (D^2 + (4R)^2 - (4R)^2) / (2 <em> D </em> 2* R) = D / 4R. And as before we have to compensate for the fact that the circles don’t have the same position by calculating angle atan2.</p>
<p>With theta we can get the center coordinate of the third circle in the same way as we before calculated the first tangent position of the inner and outer tangent: Cx = Ax + 2R <em> cos theta and Cy = Ay + 2R </em> sin theta.</p>
<p>Now E is on the same line as BC and D is one the same line as AC. So we can calculate the direction between BC and AC and normalize it. To get tangent coordinates we just multiply the direction with the radius R and add it to the center coordinate C of the third circle.</p>
<p>And that’s it! The boring math part is over. Well, you’ll have to learn on your own how to calculate arc lengths and how to iterate over the path with a numerical method, but that’s easy. Now we will create something looking like this in the next part (the white line is the shortest of the Dubins paths):</p>
<p><img src="https://raw.githubusercontent.com/tospan/tospan.github.io/source/source/_images/unity/dubins-paths-tesla.png" alt="Dubins paths in Unity"></p>
<h2 id="Dubins-Paths-in-Unity"><a href="#Dubins-Paths-in-Unity" class="headerlink" title="Dubins Paths in Unity"></a>Dubins Paths in Unity</h2><p>First of all we need a basic scene, so add a large plane that will act as ground. You then need to build a car consisting of 2 boxes (so we can tell which part of the car is the front to make it easier to debug). The car’s size should be something like 2 m * 5 m, like a real car. Also don’t forget to remove all colliders of everything we add in this part (except the ground). Duplicate the car because we need two cars (one real car and one car that the real car will travel towards).</p>
<p>Then add 4 circles with the same radius as the turning radius (R in the previous section) you want. My turning radius is 11 m so my circles have the x- and z-scale 22. Also add an empty gameobject called “Dubins Paths”. Parent the circles to this gameobject to get a cleaner workspace. Then add 6 gameobject with line renderers attached to them. These line renderers will display our final Dubins paths.</p>
<p>Everything should now look like this:</p>
<p><img src="https://raw.githubusercontent.com/tospan/tospan.github.io/source/source/_images/unity/start-scene.png" alt="Unity dubins paths start scene"></p>
<h3 id="Script-1-Move-and-Rotate-the-target-car"><a href="#Script-1-Move-and-Rotate-the-target-car" class="headerlink" title="Script 1 - Move and Rotate the target car"></a>Script 1 - Move and Rotate the target car</h3><p>We will be able to move and rotate the target car (the car we want to reach) with the mouse and some keys. So add this script to the “Goal car.”</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">using</span> UnityEngine;</div><div class="line"><span class="keyword">using</span> System.Collections;</div><div class="line"></div><div class="line"><span class="keyword">namespace</span> <span class="title">DubinsPathsTutorial</span></div><div class="line">&#123;</div><div class="line">    <span class="comment">//Move and rotate the car we want to reach with a Dubins Path</span></div><div class="line">    <span class="comment">//Attach the script to the target car</span></div><div class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">MoveRotateCar</span> : <span class="title">MonoBehaviour</span> </div><div class="line">    &#123;</div><div class="line">        <span class="comment">//The scene's camera</span></div><div class="line">        <span class="keyword">public</span> Camera cameraObj;</div><div class="line">	</div><div class="line">	</div><div class="line">	    <span class="function"><span class="keyword">void</span> <span class="title">Update</span>(<span class="params"></span>) </span></div><div class="line">	    &#123;</div><div class="line">            <span class="comment">//Move the target car with the mouse</span></div><div class="line">            MoveCar();</div><div class="line"></div><div class="line">            <span class="comment">//Rotate the target car around y</span></div><div class="line">            RotateCar();</div><div class="line">        &#125;</div><div class="line"></div><div class="line"></div><div class="line">        <span class="comment">//Move the car with the mouse</span></div><div class="line">        <span class="function"><span class="keyword">void</span> <span class="title">MoveCar</span>(<span class="params"></span>)</span></div><div class="line">        &#123;</div><div class="line">            <span class="comment">//Fire a ray from the mouse position</span></div><div class="line">            Ray ray = cameraObj.ScreenPointToRay(Input.mousePosition);</div><div class="line"></div><div class="line">            RaycastHit hit;</div><div class="line"></div><div class="line">            <span class="keyword">if</span> (Physics.Raycast(ray, <span class="keyword">out</span> hit))</div><div class="line">            &#123;</div><div class="line">                <span class="comment">//Where the the ray hot the ground?</span></div><div class="line">                Vector3 hitCoordinate = hit.point;</div><div class="line"></div><div class="line">                hitCoordinate.y = <span class="number">0</span>f;</div><div class="line"></div><div class="line">                <span class="comment">//Move the car to that position</span></div><div class="line">                transform.position = hitCoordinate;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line"></div><div class="line">        <span class="comment">//Rotate the car around its axis</span></div><div class="line">        <span class="function"><span class="keyword">void</span> <span class="title">RotateCar</span>(<span class="params"></span>)</span></div><div class="line">        &#123;</div><div class="line">            <span class="keyword">float</span> rotationSpeed = <span class="number">80</span>f;</div><div class="line"></div><div class="line">            <span class="comment">//Rotate counter clock-wise</span></div><div class="line">            <span class="keyword">if</span> (Input.GetKey(KeyCode.Q))</div><div class="line">            &#123;</div><div class="line">                transform.Rotate(-Vector3.up * Time.deltaTime * rotationSpeed);</div><div class="line">            &#125;</div><div class="line">            <span class="function"><span class="keyword">else</span> <span class="title">if</span> (<span class="params">Input.GetKey(KeyCode.E</span>))</span></div><div class="line">            &#123;</div><div class="line">                transform.Rotate(Vector3.up * Time.deltaTime * rotationSpeed);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Script-2-Debug-the-Dubins-paths"><a href="#Script-2-Debug-the-Dubins-paths" class="headerlink" title="Script 2 - Debug the Dubins paths"></a>Script 2 - Debug the Dubins paths</h3><p>The script is the main script that will control everything else and is the only script you have to attach to the gameobject “Dubins Paths”.</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">using</span> UnityEngine;</div><div class="line"><span class="keyword">using</span> System.Collections;</div><div class="line"><span class="keyword">using</span> System.Collections.Generic;</div><div class="line"></div><div class="line"><span class="keyword">namespace</span> <span class="title">DubinsPathsTutorial</span></div><div class="line">&#123;</div><div class="line">    <span class="comment">//Display the final Dubins Paths</span></div><div class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">DubinsDebug</span> : <span class="title">MonoBehaviour</span></div><div class="line">    &#123;</div><div class="line">        <span class="comment">//Everything we need to add in the editor</span></div><div class="line">        <span class="comment">//Circles</span></div><div class="line">        <span class="keyword">public</span> Transform goalCircleLeft;</div><div class="line">        <span class="keyword">public</span> Transform goalCircleRight;</div><div class="line">        <span class="keyword">public</span> Transform startCircleLeft;</div><div class="line">        <span class="keyword">public</span> Transform startCircleRight;</div><div class="line">        <span class="comment">//Line renderers</span></div><div class="line">        <span class="keyword">public</span> LineRenderer lineRSR;</div><div class="line">        <span class="keyword">public</span> LineRenderer lineLSL;</div><div class="line">        <span class="keyword">public</span> LineRenderer lineRSL;</div><div class="line">        <span class="keyword">public</span> LineRenderer lineLSR;</div><div class="line">        <span class="keyword">public</span> LineRenderer lineRLR;</div><div class="line">        <span class="keyword">public</span> LineRenderer lineLRL;</div><div class="line">        <span class="comment">//The cars we generate paths to/from</span></div><div class="line">        <span class="keyword">public</span> Transform startCar;</div><div class="line">        <span class="keyword">public</span> Transform goalCar;</div><div class="line"></div><div class="line">        <span class="comment">//Objects</span></div><div class="line">        DubinsGeneratePaths dubinsPathGenerator;</div><div class="line"></div><div class="line"></div><div class="line">        <span class="function"><span class="keyword">void</span> <span class="title">Start</span>(<span class="params"></span>)</span></div><div class="line">        &#123;</div><div class="line">            dubinsPathGenerator = <span class="keyword">new</span> DubinsGeneratePaths();</div><div class="line">        &#125;</div><div class="line"></div><div class="line"></div><div class="line">        <span class="function"><span class="keyword">void</span> <span class="title">Update</span>(<span class="params"></span>)</span></div><div class="line">        &#123;</div><div class="line">            <span class="comment">//To generate paths we need the position and rotation (heading) of the cars</span></div><div class="line">            Vector3 startPos = startCar.position;</div><div class="line">            Vector3 goalPos = goalCar.position;</div><div class="line">            <span class="comment">//Heading is in radians</span></div><div class="line">            <span class="keyword">float</span> startHeading = startCar.eulerAngles.y * Mathf.Deg2Rad;</div><div class="line">            <span class="keyword">float</span> goalHeading = goalCar.eulerAngles.y * Mathf.Deg2Rad;</div><div class="line">            </div><div class="line">            <span class="comment">//Get all valid Dubins paths</span></div><div class="line">            List&lt;OneDubinsPath&gt; pathDataList = dubinsPathGenerator.GetAllDubinsPaths(</div><div class="line">                startPos, </div><div class="line">                startHeading,</div><div class="line">                goalPos,</div><div class="line">                goalHeading);</div><div class="line"></div><div class="line">            <span class="comment">//If we have paths</span></div><div class="line">            <span class="keyword">if</span> (pathDataList.Count &gt; <span class="number">0</span>)</div><div class="line">            &#123;</div><div class="line">                <span class="comment">//Display all paths with line renderers</span></div><div class="line">                DebugAllPaths(pathDataList);</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            <span class="comment">//Position the left and right circles</span></div><div class="line">            PositionLeftRightCircle();</div><div class="line">        &#125;</div><div class="line"></div><div class="line"></div><div class="line">        <span class="comment">//Position the left and right circle objects for debugging</span></div><div class="line">        <span class="function"><span class="keyword">void</span> <span class="title">PositionLeftRightCircle</span>(<span class="params"></span>)</span></div><div class="line">        &#123;</div><div class="line">            goalCircleLeft.position = dubinsPathGenerator.goalLeftCircle;</div><div class="line">            goalCircleRight.position = dubinsPathGenerator.goalRightCircle;</div><div class="line"></div><div class="line">            startCircleLeft.position = dubinsPathGenerator.startLeftCircle;</div><div class="line">            startCircleRight.position = dubinsPathGenerator.startRightCircle;</div><div class="line">        &#125;</div><div class="line"></div><div class="line"></div><div class="line">        <span class="comment">//Displaying all Dubins paths with line renderers for debugging</span></div><div class="line">        <span class="function"><span class="keyword">void</span> <span class="title">DebugAllPaths</span>(<span class="params">List&lt;OneDubinsPath&gt; pathDataList</span>)</span></div><div class="line">        &#123;</div><div class="line">            <span class="comment">//Deactivate all line renderers (we activate them if a path is available)</span></div><div class="line">            DeactivateLineRenderers();</div><div class="line"></div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; pathDataList.Count; i++)</div><div class="line">            &#123;</div><div class="line">                PathType currentPathType = pathDataList[i].pathType;</div><div class="line"></div><div class="line">                <span class="keyword">switch</span> (currentPathType)</div><div class="line">                &#123;</div><div class="line">                    <span class="keyword">case</span> PathType.LRL:</div><div class="line">                        DisplayPath(pathDataList[i], lineLRL);</div><div class="line">                        <span class="keyword">break</span>;</div><div class="line">                    <span class="keyword">case</span> PathType.RLR:</div><div class="line">                        DisplayPath(pathDataList[i], lineRLR);</div><div class="line">                        <span class="keyword">break</span>;</div><div class="line">                    <span class="keyword">case</span> PathType.LSR:</div><div class="line">                        DisplayPath(pathDataList[i], lineLSR);</div><div class="line">                        <span class="keyword">break</span>;</div><div class="line">                    <span class="keyword">case</span> PathType.RSL:</div><div class="line">                        DisplayPath(pathDataList[i], lineRSL);</div><div class="line">                        <span class="keyword">break</span>;</div><div class="line">                    <span class="keyword">case</span> PathType.RSR:</div><div class="line">                        DisplayPath(pathDataList[i], lineRSR);</div><div class="line">                        <span class="keyword">break</span>;</div><div class="line">                    <span class="keyword">case</span> PathType.LSL:</div><div class="line">                        DisplayPath(pathDataList[i], lineLSL);</div><div class="line">                        <span class="keyword">break</span>;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line"></div><div class="line">        <span class="comment">//Display a path with a line renderer</span></div><div class="line">        <span class="function"><span class="keyword">void</span> <span class="title">DisplayPath</span>(<span class="params">OneDubinsPath pathData, LineRenderer lineRenderer</span>)</span></div><div class="line">        &#123;</div><div class="line">            <span class="comment">//Activate the line renderer</span></div><div class="line">            lineRenderer.gameObject.SetActive(<span class="literal">true</span>);</div><div class="line"></div><div class="line">            <span class="comment">//The coordinates of the path</span></div><div class="line">            List pathCoordinates = pathData.pathCoordinates;</div><div class="line"></div><div class="line">            <span class="comment">//Display the final line</span></div><div class="line">            lineRenderer.SetVertexCount(pathCoordinates.Count);</div><div class="line"></div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; pathCoordinates.Count; i++)</div><div class="line">            &#123;</div><div class="line">                lineRenderer.SetPosition(i, pathCoordinates[i]);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line"></div><div class="line">        <span class="comment">//Deactivate all line renderers in case a circle is not possible</span></div><div class="line">        <span class="comment">//Then we dont want to show the old circle</span></div><div class="line">        <span class="function"><span class="keyword">void</span> <span class="title">DeactivateLineRenderers</span>(<span class="params"></span>)</span></div><div class="line">        &#123;</div><div class="line">            lineLRL.gameObject.SetActive(<span class="literal">false</span>);</div><div class="line">            lineRLR.gameObject.SetActive(<span class="literal">false</span>);</div><div class="line">            lineLSL.gameObject.SetActive(<span class="literal">false</span>);</div><div class="line">            lineRSR.gameObject.SetActive(<span class="literal">false</span>);</div><div class="line">            lineLSR.gameObject.SetActive(<span class="literal">false</span>);</div><div class="line">            lineRSL.gameObject.SetActive(<span class="literal">false</span>);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Script-3-Generate-Dubins-paths"><a href="#Script-3-Generate-Dubins-paths" class="headerlink" title="Script 3 - Generate Dubins paths"></a>Script 3 - Generate Dubins paths</h3><p>This script will generate the Dubins paths and sort them.</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div><div class="line">288</div><div class="line">289</div><div class="line">290</div><div class="line">291</div><div class="line">292</div><div class="line">293</div><div class="line">294</div><div class="line">295</div><div class="line">296</div><div class="line">297</div><div class="line">298</div><div class="line">299</div><div class="line">300</div><div class="line">301</div><div class="line">302</div><div class="line">303</div><div class="line">304</div><div class="line">305</div><div class="line">306</div><div class="line">307</div><div class="line">308</div><div class="line">309</div><div class="line">310</div><div class="line">311</div><div class="line">312</div><div class="line">313</div><div class="line">314</div><div class="line">315</div><div class="line">316</div><div class="line">317</div><div class="line">318</div><div class="line">319</div><div class="line">320</div><div class="line">321</div><div class="line">322</div><div class="line">323</div><div class="line">324</div><div class="line">325</div><div class="line">326</div><div class="line">327</div><div class="line">328</div><div class="line">329</div><div class="line">330</div><div class="line">331</div><div class="line">332</div><div class="line">333</div><div class="line">334</div><div class="line">335</div><div class="line">336</div><div class="line">337</div><div class="line">338</div><div class="line">339</div><div class="line">340</div><div class="line">341</div><div class="line">342</div><div class="line">343</div><div class="line">344</div><div class="line">345</div><div class="line">346</div><div class="line">347</div><div class="line">348</div><div class="line">349</div><div class="line">350</div><div class="line">351</div><div class="line">352</div><div class="line">353</div><div class="line">354</div><div class="line">355</div><div class="line">356</div><div class="line">357</div><div class="line">358</div><div class="line">359</div><div class="line">360</div><div class="line">361</div><div class="line">362</div><div class="line">363</div><div class="line">364</div><div class="line">365</div><div class="line">366</div><div class="line">367</div><div class="line">368</div><div class="line">369</div><div class="line">370</div><div class="line">371</div><div class="line">372</div><div class="line">373</div><div class="line">374</div><div class="line">375</div><div class="line">376</div><div class="line">377</div><div class="line">378</div><div class="line">379</div><div class="line">380</div><div class="line">381</div><div class="line">382</div><div class="line">383</div><div class="line">384</div><div class="line">385</div><div class="line">386</div><div class="line">387</div><div class="line">388</div><div class="line">389</div><div class="line">390</div><div class="line">391</div><div class="line">392</div><div class="line">393</div><div class="line">394</div><div class="line">395</div><div class="line">396</div><div class="line">397</div><div class="line">398</div><div class="line">399</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">using</span> UnityEngine;</div><div class="line"><span class="keyword">using</span> System.Collections;</div><div class="line"><span class="keyword">using</span> System.Collections.Generic;</div><div class="line"></div><div class="line"><span class="keyword">namespace</span> <span class="title">DubinsPathsTutorial</span></div><div class="line">&#123;</div><div class="line">    <span class="comment">//Generates Dubins paths</span></div><div class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">DubinsGeneratePaths</span></div><div class="line">    &#123;</div><div class="line">        <span class="comment">//The 4 different circles we have that sits to the left/right of the start/goal</span></div><div class="line">        <span class="comment">//Public so we can position the circle objects for debugging</span></div><div class="line">        <span class="keyword">public</span> Vector3 startLeftCircle;</div><div class="line">        <span class="keyword">public</span> Vector3 startRightCircle;</div><div class="line">        <span class="keyword">public</span> Vector3 goalLeftCircle;</div><div class="line">        <span class="keyword">public</span> Vector3 goalRightCircle;</div><div class="line"></div><div class="line">        <span class="comment">//To generate paths we need the position and rotation (heading) of the cars</span></div><div class="line">        Vector3 startPos;</div><div class="line">        Vector3 goalPos;</div><div class="line">        <span class="comment">//Heading is in radians</span></div><div class="line">        <span class="keyword">float</span> startHeading;</div><div class="line">        <span class="keyword">float</span> goalHeading;</div><div class="line"></div><div class="line">        <span class="comment">//Where we store all path data so we can sort and find the shortest path</span></div><div class="line">        List&lt;OneDubinsPath&gt; pathDataList = <span class="keyword">new</span> List&lt;OneDubinsPath&gt;();</div><div class="line"></div><div class="line"></div><div class="line">        <span class="comment">//Get all valid Dubins paths sorted from shortest to longest</span></div><div class="line">        <span class="function"><span class="keyword">public</span> List&lt;OneDubinsPath&gt; <span class="title">GetAllDubinsPaths</span>(<span class="params">Vector3 startPos, <span class="keyword">float</span> startHeading, Vector3 goalPos, <span class="keyword">float</span> goalHeading</span>)</span></div><div class="line">        &#123;</div><div class="line">            <span class="keyword">this</span>.startPos = startPos;</div><div class="line">            <span class="keyword">this</span>.goalPos = goalPos;</div><div class="line">            <span class="keyword">this</span>.startHeading = startHeading;</div><div class="line">            <span class="keyword">this</span>.goalHeading = goalHeading;</div><div class="line"></div><div class="line">            <span class="comment">//Reset the list with all Dubins paths</span></div><div class="line">            pathDataList.Clear();</div><div class="line"></div><div class="line">            <span class="comment">//Position the circles that are to the left/right of the cars</span></div><div class="line">            PositionLeftRightCircles();</div><div class="line"></div><div class="line">            <span class="comment">//Find the length of each path with tangent coordinates</span></div><div class="line">            CalculateDubinsPathsLengths();</div><div class="line"></div><div class="line">            <span class="comment">//If we have paths</span></div><div class="line">            <span class="keyword">if</span> (pathDataList.Count &gt; <span class="number">0</span>)</div><div class="line">            &#123;</div><div class="line">                <span class="comment">//Sort the list with paths so the shortest path is first</span></div><div class="line">                pathDataList.Sort((x, y) =&gt; x.totalLength.CompareTo(y.totalLength));</div><div class="line"></div><div class="line">                <span class="comment">//Generate the final coordinates of the path from tangent points and segment lengths</span></div><div class="line">                GeneratePathCoordinates();</div><div class="line"></div><div class="line">                <span class="keyword">return</span> pathDataList;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            <span class="comment">//No paths could be found</span></div><div class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</div><div class="line">        &#125;</div><div class="line"></div><div class="line"></div><div class="line">        <span class="comment">//Position the left and right circles that are to the left/right of the target and the car</span></div><div class="line">        <span class="function"><span class="keyword">void</span> <span class="title">PositionLeftRightCircles</span>(<span class="params"></span>)</span></div><div class="line">        &#123;</div><div class="line">            <span class="comment">//Goal pos</span></div><div class="line">            goalRightCircle = DubinsMath.GetRightCircleCenterPos(goalPos, goalHeading);</div><div class="line"></div><div class="line">            goalLeftCircle = DubinsMath.GetLeftCircleCenterPos(goalPos, goalHeading);</div><div class="line"></div><div class="line"></div><div class="line">            <span class="comment">//Start pos</span></div><div class="line">            startRightCircle = DubinsMath.GetRightCircleCenterPos(startPos, startHeading);</div><div class="line"></div><div class="line">            startLeftCircle = DubinsMath.GetLeftCircleCenterPos(startPos, startHeading);</div><div class="line">        &#125;</div><div class="line"></div><div class="line"></div><div class="line">        <span class="comment">//</span></div><div class="line">        <span class="comment">//Calculate the path lengths of all Dubins paths by using tangent points</span></div><div class="line">        <span class="comment">//</span></div><div class="line">        <span class="function"><span class="keyword">void</span> <span class="title">CalculateDubinsPathsLengths</span>(<span class="params"></span>)</span></div><div class="line">        &#123;</div><div class="line">            <span class="comment">//RSR and LSL is only working if the circles don't have the same position</span></div><div class="line">            </div><div class="line">            <span class="comment">//RSR</span></div><div class="line">            <span class="keyword">if</span> (startRightCircle.x != goalRightCircle.x &amp;&amp; startRightCircle.z != goalRightCircle.z)</div><div class="line">            &#123;</div><div class="line">                Get_RSR_Length();</div><div class="line">            &#125;</div><div class="line">            </div><div class="line">            <span class="comment">//LSL</span></div><div class="line">            <span class="keyword">if</span> (startLeftCircle.x != goalLeftCircle.x &amp;&amp; startLeftCircle.z != goalLeftCircle.z)</div><div class="line">            &#123;</div><div class="line">                Get_LSL_Length();</div><div class="line">            &#125;</div><div class="line"></div><div class="line"></div><div class="line">            <span class="comment">//RSL and LSR is only working of the circles don't intersect</span></div><div class="line">            <span class="keyword">float</span> comparisonSqr = DubinsMath.turningRadius * <span class="number">2</span>f * DubinsMath.turningRadius * <span class="number">2</span>f;</div><div class="line"></div><div class="line">            <span class="comment">//RSL</span></div><div class="line">            <span class="keyword">if</span> ((startRightCircle - goalLeftCircle).sqrMagnitude &gt; comparisonSqr)</div><div class="line">            &#123;</div><div class="line">                Get_RSL_Length();</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            <span class="comment">//LSR</span></div><div class="line">            <span class="keyword">if</span> ((startLeftCircle - goalRightCircle).sqrMagnitude &gt; comparisonSqr)</div><div class="line">            &#123;</div><div class="line">                Get_LSR_Length();</div><div class="line">            &#125;</div><div class="line"></div><div class="line"></div><div class="line">            <span class="comment">//With the LRL and RLR paths, the distance between the circles have to be less than 4 * r</span></div><div class="line">            comparisonSqr = <span class="number">4</span>f * DubinsMath.turningRadius * <span class="number">4</span>f * DubinsMath.turningRadius;</div><div class="line"></div><div class="line">            <span class="comment">//RLR        </span></div><div class="line">            <span class="keyword">if</span> ((startRightCircle - goalRightCircle).sqrMagnitude &lt; comparisonSqr)</div><div class="line">            &#123;</div><div class="line">                Get_RLR_Length();</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            <span class="comment">//LRL</span></div><div class="line">            <span class="keyword">if</span> ((startLeftCircle - goalLeftCircle).sqrMagnitude &lt; comparisonSqr)</div><div class="line">            &#123;</div><div class="line">                Get_LRL_Length();</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line"></div><div class="line">        <span class="comment">//RSR</span></div><div class="line">        <span class="function"><span class="keyword">void</span> <span class="title">Get_RSR_Length</span>(<span class="params"></span>)</span></div><div class="line">        &#123;</div><div class="line">            <span class="comment">//Find both tangent positons</span></div><div class="line">            Vector3 startTangent = Vector3.zero;</div><div class="line">            Vector3 goalTangent = Vector3.zero;</div><div class="line"></div><div class="line">            DubinsMath.LSLorRSR(startRightCircle, goalRightCircle, <span class="literal">false</span>, <span class="keyword">out</span> startTangent, <span class="keyword">out</span> goalTangent);</div><div class="line"></div><div class="line">            <span class="comment">//Calculate lengths</span></div><div class="line">            <span class="keyword">float</span> length1 = DubinsMath.GetArcLength(startRightCircle, startPos, startTangent, <span class="literal">false</span>);</div><div class="line"></div><div class="line">            <span class="keyword">float</span> length2 = (startTangent - goalTangent).magnitude;</div><div class="line"></div><div class="line">            <span class="keyword">float</span> length3 = DubinsMath.GetArcLength(goalRightCircle, goalTangent, goalPos, <span class="literal">false</span>);</div><div class="line"></div><div class="line">            <span class="comment">//Save the data</span></div><div class="line">            OneDubinsPath pathData = <span class="keyword">new</span> OneDubinsPath(length1, length2, length3, startTangent, goalTangent, PathType.RSR);</div><div class="line"></div><div class="line">            <span class="comment">//We also need this data to simplify when generating the final path</span></div><div class="line">            pathData.segment2Turning = <span class="literal">false</span>;</div><div class="line"></div><div class="line">            <span class="comment">//RSR</span></div><div class="line">            pathData.SetIfTurningRight(<span class="literal">true</span>, <span class="literal">false</span>, <span class="literal">true</span>);</div><div class="line"></div><div class="line">            <span class="comment">//Add the path to the collection of all paths</span></div><div class="line">            pathDataList.Add(pathData);</div><div class="line">        &#125;</div><div class="line"></div><div class="line"></div><div class="line">        <span class="comment">//LSL</span></div><div class="line">        <span class="function"><span class="keyword">void</span> <span class="title">Get_LSL_Length</span>(<span class="params"></span>)</span></div><div class="line">        &#123;</div><div class="line">            <span class="comment">//Find both tangent positions</span></div><div class="line">            Vector3 startTangent = Vector3.zero;</div><div class="line">            Vector3 goalTangent = Vector3.zero;</div><div class="line"></div><div class="line">            DubinsMath.LSLorRSR(startLeftCircle, goalLeftCircle, <span class="literal">true</span>, <span class="keyword">out</span> startTangent, <span class="keyword">out</span> goalTangent);</div><div class="line"></div><div class="line">            <span class="comment">//Calculate lengths</span></div><div class="line">            <span class="keyword">float</span> length1 = DubinsMath.GetArcLength(startLeftCircle, startPos, startTangent, <span class="literal">true</span>);</div><div class="line"></div><div class="line">            <span class="keyword">float</span> length2 = (startTangent - goalTangent).magnitude;</div><div class="line"></div><div class="line">            <span class="keyword">float</span> length3 = DubinsMath.GetArcLength(goalLeftCircle, goalTangent, goalPos, <span class="literal">true</span>);</div><div class="line"></div><div class="line">            <span class="comment">//Save the data</span></div><div class="line">            OneDubinsPath pathData = <span class="keyword">new</span> OneDubinsPath(length1, length2, length3, startTangent, goalTangent, PathType.LSL);</div><div class="line"></div><div class="line">            <span class="comment">//We also need this data to simplify when generating the final path</span></div><div class="line">            pathData.segment2Turning = <span class="literal">false</span>;</div><div class="line"></div><div class="line">            <span class="comment">//LSL</span></div><div class="line">            pathData.SetIfTurningRight(<span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">false</span>);</div><div class="line"></div><div class="line">            <span class="comment">//Add the path to the collection of all paths</span></div><div class="line">            pathDataList.Add(pathData);</div><div class="line">        &#125;</div><div class="line"></div><div class="line"></div><div class="line">        <span class="comment">//RSL</span></div><div class="line">        <span class="function"><span class="keyword">void</span> <span class="title">Get_RSL_Length</span>(<span class="params"></span>)</span></div><div class="line">        &#123;</div><div class="line">            <span class="comment">//Find both tangent positions</span></div><div class="line">            Vector3 startTangent = Vector3.zero;</div><div class="line">            Vector3 goalTangent = Vector3.zero;</div><div class="line"></div><div class="line">            DubinsMath.RSLorLSR(startRightCircle, goalLeftCircle, <span class="literal">false</span>, <span class="keyword">out</span> startTangent, <span class="keyword">out</span> goalTangent);</div><div class="line"></div><div class="line">            <span class="comment">//Calculate lengths</span></div><div class="line">            <span class="keyword">float</span> length1 = DubinsMath.GetArcLength(startRightCircle, startPos, startTangent, <span class="literal">false</span>);</div><div class="line"></div><div class="line">            <span class="keyword">float</span> length2 = (startTangent - goalTangent).magnitude;</div><div class="line"></div><div class="line">            <span class="keyword">float</span> length3 = DubinsMath.GetArcLength(goalLeftCircle, goalTangent, goalPos, <span class="literal">true</span>);</div><div class="line"></div><div class="line">            <span class="comment">//Save the data</span></div><div class="line">            OneDubinsPath pathData = <span class="keyword">new</span> OneDubinsPath(length1, length2, length3, startTangent, goalTangent, PathType.RSL);</div><div class="line"></div><div class="line">            <span class="comment">//We also need this data to simplify when generating the final path</span></div><div class="line">            pathData.segment2Turning = <span class="literal">false</span>;</div><div class="line"></div><div class="line">            <span class="comment">//RSL</span></div><div class="line">            pathData.SetIfTurningRight(<span class="literal">true</span>, <span class="literal">false</span>, <span class="literal">false</span>);</div><div class="line"></div><div class="line">            <span class="comment">//Add the path to the collection of all paths</span></div><div class="line">            pathDataList.Add(pathData);</div><div class="line">        &#125;</div><div class="line"></div><div class="line"></div><div class="line">        <span class="comment">//LSR</span></div><div class="line">        <span class="function"><span class="keyword">void</span> <span class="title">Get_LSR_Length</span>(<span class="params"></span>)</span></div><div class="line">        &#123;</div><div class="line">            <span class="comment">//Find both tangent positions</span></div><div class="line">            Vector3 startTangent = Vector3.zero;</div><div class="line">            Vector3 goalTangent = Vector3.zero;</div><div class="line"></div><div class="line">            DubinsMath.RSLorLSR(startLeftCircle, goalRightCircle, <span class="literal">true</span>, <span class="keyword">out</span> startTangent, <span class="keyword">out</span> goalTangent);</div><div class="line"></div><div class="line">            <span class="comment">//Calculate lengths</span></div><div class="line">            <span class="keyword">float</span> length1 = DubinsMath.GetArcLength(startLeftCircle, startPos, startTangent, <span class="literal">true</span>);</div><div class="line"></div><div class="line">            <span class="keyword">float</span> length2 = (startTangent - goalTangent).magnitude;</div><div class="line"></div><div class="line">            <span class="keyword">float</span> length3 = DubinsMath.GetArcLength(goalRightCircle, goalTangent, goalPos, <span class="literal">false</span>);</div><div class="line"></div><div class="line">            <span class="comment">//Save the data</span></div><div class="line">            OneDubinsPath pathData = <span class="keyword">new</span> OneDubinsPath(length1, length2, length3, startTangent, goalTangent, PathType.LSR);</div><div class="line"></div><div class="line">            <span class="comment">//We also need this data to simplify when generating the final path</span></div><div class="line">            pathData.segment2Turning = <span class="literal">false</span>;</div><div class="line"></div><div class="line">            <span class="comment">//LSR</span></div><div class="line">            pathData.SetIfTurningRight(<span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">true</span>);</div><div class="line"></div><div class="line">            <span class="comment">//Add the path to the collection of all paths</span></div><div class="line">            pathDataList.Add(pathData);</div><div class="line">        &#125;</div><div class="line"></div><div class="line"></div><div class="line">        <span class="comment">//RLR</span></div><div class="line">        <span class="function"><span class="keyword">void</span> <span class="title">Get_RLR_Length</span>(<span class="params"></span>)</span></div><div class="line">        &#123;</div><div class="line">            <span class="comment">//Find both tangent positions and the position of the 3rd circle</span></div><div class="line">            Vector3 startTangent = Vector3.zero;</div><div class="line">            Vector3 goalTangent = Vector3.zero;</div><div class="line">            <span class="comment">//Center of the 3rd circle</span></div><div class="line">            Vector3 middleCircle = Vector3.zero;</div><div class="line"></div><div class="line">            DubinsMath.GetRLRorLRLTangents(</div><div class="line">                startRightCircle,</div><div class="line">                goalRightCircle,</div><div class="line">                <span class="literal">false</span>,</div><div class="line">                <span class="keyword">out</span> startTangent,</div><div class="line">                <span class="keyword">out</span> goalTangent,</div><div class="line">                <span class="keyword">out</span> middleCircle);</div><div class="line"></div><div class="line">            <span class="comment">//Calculate lengths</span></div><div class="line">            <span class="keyword">float</span> length1 = DubinsMath.GetArcLength(startRightCircle, startPos, startTangent, <span class="literal">false</span>);</div><div class="line"></div><div class="line">            <span class="keyword">float</span> length2 = DubinsMath.GetArcLength(middleCircle, startTangent, goalTangent, <span class="literal">true</span>);</div><div class="line"></div><div class="line">            <span class="keyword">float</span> length3 = DubinsMath.GetArcLength(goalRightCircle, goalTangent, goalPos, <span class="literal">false</span>);</div><div class="line"></div><div class="line">            <span class="comment">//Save the data</span></div><div class="line">            OneDubinsPath pathData = <span class="keyword">new</span> OneDubinsPath(length1, length2, length3, startTangent, goalTangent, PathType.RLR);</div><div class="line"></div><div class="line">            <span class="comment">//We also need this data to simplify when generating the final path</span></div><div class="line">            pathData.segment2Turning = <span class="literal">true</span>;</div><div class="line"></div><div class="line">            <span class="comment">//RLR</span></div><div class="line">            pathData.SetIfTurningRight(<span class="literal">true</span>, <span class="literal">false</span>, <span class="literal">true</span>);</div><div class="line"></div><div class="line">            <span class="comment">//Add the path to the collection of all paths</span></div><div class="line">            pathDataList.Add(pathData);</div><div class="line">        &#125;</div><div class="line"></div><div class="line"></div><div class="line">        <span class="comment">//LRL</span></div><div class="line">        <span class="function"><span class="keyword">void</span> <span class="title">Get_LRL_Length</span>(<span class="params"></span>)</span></div><div class="line">        &#123;</div><div class="line">            <span class="comment">//Find both tangent positions and the position of the 3rd circle</span></div><div class="line">            Vector3 startTangent = Vector3.zero;</div><div class="line">            Vector3 goalTangent = Vector3.zero;</div><div class="line">            <span class="comment">//Center of the 3rd circle</span></div><div class="line">            Vector3 middleCircle = Vector3.zero;</div><div class="line"></div><div class="line">            DubinsMath.GetRLRorLRLTangents(</div><div class="line">                startLeftCircle,</div><div class="line">                goalLeftCircle,</div><div class="line">                <span class="literal">true</span>,</div><div class="line">                <span class="keyword">out</span> startTangent,</div><div class="line">                <span class="keyword">out</span> goalTangent,</div><div class="line">                <span class="keyword">out</span> middleCircle);</div><div class="line"></div><div class="line">            <span class="comment">//Calculate the total length of this path</span></div><div class="line">            <span class="keyword">float</span> length1 = DubinsMath.GetArcLength(startLeftCircle, startPos, startTangent, <span class="literal">true</span>);</div><div class="line"></div><div class="line">            <span class="keyword">float</span> length2 = DubinsMath.GetArcLength(middleCircle, startTangent, goalTangent, <span class="literal">false</span>);</div><div class="line"></div><div class="line">            <span class="keyword">float</span> length3 = DubinsMath.GetArcLength(goalLeftCircle, goalTangent, goalPos, <span class="literal">true</span>);</div><div class="line"></div><div class="line">            <span class="comment">//Save the data</span></div><div class="line">            OneDubinsPath pathData = <span class="keyword">new</span> OneDubinsPath(length1, length2, length3, startTangent, goalTangent, PathType.LRL);</div><div class="line"></div><div class="line">            <span class="comment">//We also need this data to simplify when generating the final path</span></div><div class="line">            pathData.segment2Turning = <span class="literal">true</span>;</div><div class="line"></div><div class="line">            <span class="comment">//LRL</span></div><div class="line">            pathData.SetIfTurningRight(<span class="literal">false</span>, <span class="literal">true</span>, <span class="literal">false</span>);</div><div class="line"></div><div class="line">            <span class="comment">//Add the path to the collection of all paths</span></div><div class="line">            pathDataList.Add(pathData);</div><div class="line">        &#125;</div><div class="line"></div><div class="line"></div><div class="line">        <span class="comment">//</span></div><div class="line">        <span class="comment">// Generate the final path from the tangent points</span></div><div class="line">        <span class="comment">//</span></div><div class="line"></div><div class="line">        <span class="comment">//When we have found the tangent points and lengths of each path we need to get the individual coordinates</span></div><div class="line">        <span class="comment">//of the entire path so we can travel along the path</span></div><div class="line">        <span class="function"><span class="keyword">void</span> <span class="title">GeneratePathCoordinates</span>(<span class="params"></span>)</span></div><div class="line">        &#123;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; pathDataList.Count; i++)</div><div class="line">            &#123;</div><div class="line">                GetTotalPath(pathDataList[i]);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line"></div><div class="line">        <span class="comment">//Find the coordinates of the entire path from the 2 tangents and length of each segment</span></div><div class="line">        <span class="function"><span class="keyword">void</span> <span class="title">GetTotalPath</span>(<span class="params">OneDubinsPath pathData</span>)</span></div><div class="line">        &#123;</div><div class="line">            <span class="comment">//Store the waypoints of the final path here</span></div><div class="line">            List&lt;Vector3&gt; finalPath = <span class="keyword">new</span> List&lt;Vector3&gt;();</div><div class="line"></div><div class="line">            <span class="comment">//Start position of the car</span></div><div class="line">            Vector3 currentPos = startPos;</div><div class="line">            <span class="comment">//Start heading of the car</span></div><div class="line">            <span class="keyword">float</span> theta = startHeading;</div><div class="line"></div><div class="line">            <span class="comment">//We always have to add the first position manually = the position of the car</span></div><div class="line">            finalPath.Add(currentPos);</div><div class="line"></div><div class="line">            <span class="comment">//How many line segments can we fit into this part of the path</span></div><div class="line">            <span class="keyword">int</span> segments = <span class="number">0</span>;</div><div class="line"></div><div class="line">            <span class="comment">//First</span></div><div class="line">            segments = Mathf.FloorToInt(pathData.length1 / DubinsMath.driveDistance);</div><div class="line"></div><div class="line">            DubinsMath.AddCoordinatesToPath(</div><div class="line">                <span class="keyword">ref</span> currentPos,</div><div class="line">                <span class="keyword">ref</span> theta,</div><div class="line">                finalPath,</div><div class="line">                segments,</div><div class="line">                <span class="literal">true</span>,</div><div class="line">                pathData.segment1TurningRight);</div><div class="line"></div><div class="line">            <span class="comment">//Second</span></div><div class="line">            segments = Mathf.FloorToInt(pathData.length2 / DubinsMath.driveDistance);</div><div class="line"></div><div class="line">            DubinsMath.AddCoordinatesToPath(</div><div class="line">                <span class="keyword">ref</span> currentPos,</div><div class="line">                <span class="keyword">ref</span> theta,</div><div class="line">                finalPath,</div><div class="line">                segments,</div><div class="line">                pathData.segment2Turning,</div><div class="line">                pathData.segment2TurningRight);</div><div class="line"></div><div class="line">            <span class="comment">//Third</span></div><div class="line">            segments = Mathf.FloorToInt(pathData.length3 / DubinsMath.driveDistance);</div><div class="line"></div><div class="line">            DubinsMath.AddCoordinatesToPath(</div><div class="line">                <span class="keyword">ref</span> currentPos,</div><div class="line">                <span class="keyword">ref</span> theta,</div><div class="line">                finalPath,</div><div class="line">                segments,</div><div class="line">                <span class="literal">true</span>,</div><div class="line">                pathData.segment3TurningRight);</div><div class="line"></div><div class="line">            <span class="comment">//Add the final goal coordinate</span></div><div class="line">            finalPath.Add(<span class="keyword">new</span> Vector3(goalPos.x, currentPos.y, goalPos.z));</div><div class="line"></div><div class="line">            <span class="comment">//Save the final path in the path data</span></div><div class="line">            pathData.pathCoordinates = finalPath;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Script-4-Math"><a href="#Script-4-Math" class="headerlink" title="Script 4 - Math"></a>Script 4 - Math</h3><p>This script will take care of all the fun math we calculated in section 2.</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">using</span> UnityEngine;</div><div class="line"><span class="keyword">using</span> System.Collections;</div><div class="line"><span class="keyword">using</span> System.Collections.Generic;</div><div class="line"></div><div class="line"><span class="keyword">namespace</span> <span class="title">DubinsPathsTutorial</span></div><div class="line">&#123;</div><div class="line">    <span class="comment">//To keep track of the different paths when debugging</span></div><div class="line">    <span class="keyword">public</span> <span class="keyword">enum</span> PathType &#123; RSR, LSL, RSL, LSR, RLR, LRL &#125;</div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">//Takes care of all standardized methods related the generating of Dubins paths</span></div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title">DubinsMath</span></div><div class="line">    &#123;</div><div class="line">        <span class="comment">//How far we are driving each update, the accuracy will improve if we lower the driveDistance</span></div><div class="line">        <span class="comment">//But not too low because rounding errors will appear</span></div><div class="line">        <span class="comment">//Is used to generate the coordinates of a path</span></div><div class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">float</span> driveDistance = <span class="number">0.02</span>f;</div><div class="line">        <span class="comment">//The radius the car can turn 360 degrees with</span></div><div class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">float</span> turningRadius = <span class="number">11</span>f;</div><div class="line"></div><div class="line"></div><div class="line">        <span class="comment">//Calculate center positions of the Right circle</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Vector3 <span class="title">GetRightCircleCenterPos</span>(<span class="params">Vector3 carPos, <span class="keyword">float</span> heading</span>)</span></div><div class="line">        &#123;</div><div class="line">            Vector3 rightCirclePos = Vector3.zero;</div><div class="line"></div><div class="line">            <span class="comment">//The circle is 90 degrees (pi/2 radians) to the right of the car's heading</span></div><div class="line">            rightCirclePos.x = carPos.x + turningRadius * Mathf.Sin(heading + (Mathf.PI / <span class="number">2</span>f));</div><div class="line">            rightCirclePos.z = carPos.z + turningRadius * Mathf.Cos(heading + (Mathf.PI / <span class="number">2</span>f));</div><div class="line"></div><div class="line">            <span class="keyword">return</span> rightCirclePos;</div><div class="line">        &#125;</div><div class="line"></div><div class="line"></div><div class="line">        <span class="comment">//Calculate center positions of the Left circle</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Vector3 <span class="title">GetLeftCircleCenterPos</span>(<span class="params">Vector3 carPos, <span class="keyword">float</span> heading</span>)</span></div><div class="line">        &#123;</div><div class="line">            Vector3 rightCirclePos = Vector3.zero;</div><div class="line"></div><div class="line">            <span class="comment">//The circle is 90 degrees (pi/2 radians) to the left of the car's heading</span></div><div class="line">            rightCirclePos.x = carPos.x + turningRadius * Mathf.Sin(heading - (Mathf.PI / <span class="number">2</span>f));</div><div class="line">            rightCirclePos.z = carPos.z + turningRadius * Mathf.Cos(heading - (Mathf.PI / <span class="number">2</span>f));</div><div class="line"></div><div class="line">            <span class="keyword">return</span> rightCirclePos;</div><div class="line">        &#125;</div><div class="line"></div><div class="line"></div><div class="line">        <span class="comment">//</span></div><div class="line">        <span class="comment">// Calculate the start and end positions of the tangent lines</span></div><div class="line">        <span class="comment">//</span></div><div class="line"></div><div class="line">        <span class="comment">//Outer tangent (LSL and RSR)</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">LSLorRSR</span>(<span class="params"></span></span></div><div class="line">            Vector3 startCircle,</div><div class="line">            Vector3 goalCircle,</div><div class="line">            <span class="keyword">bool</span> isBottom,</div><div class="line">            <span class="keyword">out</span> Vector3 startTangent,</div><div class="line">            <span class="keyword">out</span> Vector3 goalTangent)</div><div class="line">        &#123;</div><div class="line">            <span class="comment">//The angle to the first tangent coordinate is always 90 degrees if the both circles have the same radius</span></div><div class="line">            <span class="keyword">float</span> theta = <span class="number">90</span>f * Mathf.Deg2Rad;</div><div class="line"></div><div class="line">            <span class="comment">//Need to modify theta if the circles are not on the same height (z)</span></div><div class="line">            theta += Mathf.Atan2(goalCircle.z - startCircle.z, goalCircle.x - startCircle.x);</div><div class="line"></div><div class="line">            <span class="comment">//Add pi to get the "bottom" coordinate which is on the opposite side (180 degrees = pi)</span></div><div class="line">            <span class="keyword">if</span> (isBottom)</div><div class="line">            &#123;</div><div class="line">                theta += Mathf.PI;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            <span class="comment">//The coordinates of the first tangent points</span></div><div class="line">            <span class="keyword">float</span> xT1 = startCircle.x + turningRadius * Mathf.Cos(theta);</div><div class="line">            <span class="keyword">float</span> zT1 = startCircle.z + turningRadius * Mathf.Sin(theta);</div><div class="line"></div><div class="line">            <span class="comment">//To get the second coordinate we need a direction</span></div><div class="line">            <span class="comment">//This direction is the same as the direction between the center pos of the circles</span></div><div class="line">            Vector3 dirVec = goalCircle - startCircle;</div><div class="line"></div><div class="line">            <span class="keyword">float</span> xT2 = xT1 + dirVec.x;</div><div class="line">            <span class="keyword">float</span> zT2 = zT1 + dirVec.z;</div><div class="line"></div><div class="line">            <span class="comment">//The final coordinates of the tangent lines</span></div><div class="line">            startTangent = <span class="keyword">new</span> Vector3(xT1, <span class="number">0</span>f, zT1);</div><div class="line"></div><div class="line">            goalTangent = <span class="keyword">new</span> Vector3(xT2, <span class="number">0</span>f, zT2);</div><div class="line">        &#125;</div><div class="line"></div><div class="line"></div><div class="line">        <span class="comment">//Inner tangent (RSL and LSR)</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">RSLorLSR</span>(<span class="params"></span></span></div><div class="line">            Vector3 startCircle,</div><div class="line">            Vector3 goalCircle,</div><div class="line">            <span class="keyword">bool</span> isBottom,</div><div class="line">            <span class="keyword">out</span> Vector3 startTangent,</div><div class="line">            <span class="keyword">out</span> Vector3 goalTangent)</div><div class="line">        &#123;</div><div class="line">            <span class="comment">//Find the distance between the circles</span></div><div class="line">            <span class="keyword">float</span> D = (startCircle - goalCircle).magnitude;</div><div class="line"></div><div class="line">            <span class="comment">//If the circles have the same radius we can use cosine and not the law of cosines </span></div><div class="line">            <span class="comment">//to calculate the angle to the first tangent coordinate </span></div><div class="line">            <span class="keyword">float</span> theta = Mathf.Acos((<span class="number">2</span>f * turningRadius) / D);</div><div class="line"></div><div class="line">            <span class="comment">//If the circles is LSR, then the first tangent pos is on the other side of the center line</span></div><div class="line">            <span class="keyword">if</span> (isBottom)</div><div class="line">            &#123;</div><div class="line">                theta *= <span class="number">-1</span>f;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            <span class="comment">//Need to modify theta if the circles are not on the same height            </span></div><div class="line">            theta += Mathf.Atan2(goalCircle.z - startCircle.z, goalCircle.x - startCircle.x);</div><div class="line"></div><div class="line">            <span class="comment">//The coordinates of the first tangent point</span></div><div class="line">            <span class="keyword">float</span> xT1 = startCircle.x + turningRadius * Mathf.Cos(theta);</div><div class="line">            <span class="keyword">float</span> zT1 = startCircle.z + turningRadius * Mathf.Sin(theta);</div><div class="line"></div><div class="line">            <span class="comment">//To get the second tangent coordinate we need the direction of the tangent</span></div><div class="line">            <span class="comment">//To get the direction we move up 2 circle radius and end up at this coordinate</span></div><div class="line">            <span class="keyword">float</span> xT1_tmp = startCircle.x + <span class="number">2</span>f * turningRadius * Mathf.Cos(theta);</div><div class="line">            <span class="keyword">float</span> zT1_tmp = startCircle.z + <span class="number">2</span>f * turningRadius * Mathf.Sin(theta);</div><div class="line"></div><div class="line">            <span class="comment">//The direction is between the new coordinate and the center of the target circle</span></div><div class="line">            Vector3 dirVec = goalCircle - <span class="keyword">new</span> Vector3(xT1_tmp, <span class="number">0</span>f, zT1_tmp);</div><div class="line"></div><div class="line">            <span class="comment">//The coordinates of the second tangent point is the </span></div><div class="line">            <span class="keyword">float</span> xT2 = xT1 + dirVec.x;</div><div class="line">            <span class="keyword">float</span> zT2 = zT1 + dirVec.z;</div><div class="line"></div><div class="line">            <span class="comment">//The final coordinates of the tangent lines</span></div><div class="line">            startTangent = <span class="keyword">new</span> Vector3(xT1, <span class="number">0</span>f, zT1);</div><div class="line"></div><div class="line">            goalTangent = <span class="keyword">new</span> Vector3(xT2, <span class="number">0</span>f, zT2);</div><div class="line">        &#125;</div><div class="line"></div><div class="line"></div><div class="line">        <span class="comment">//Get the RLR or LRL tangent points</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">GetRLRorLRLTangents</span>(<span class="params"></span></span></div><div class="line">            Vector3 startCircle,</div><div class="line">            Vector3 goalCircle,</div><div class="line">            <span class="keyword">bool</span> isLRL,</div><div class="line">            <span class="keyword">out</span> Vector3 startTangent,</div><div class="line">            <span class="keyword">out</span> Vector3 goalTangent,</div><div class="line">            <span class="keyword">out</span> Vector3 middleCircle)</div><div class="line">        &#123;</div><div class="line">            <span class="comment">//The distance between the circles</span></div><div class="line">            <span class="keyword">float</span> D = (startCircle - goalCircle).magnitude;</div><div class="line"></div><div class="line">            <span class="comment">//The angle between the goal and the new 3rd circle we create with the law of cosines</span></div><div class="line">            <span class="keyword">float</span> theta = Mathf.Acos(D / (<span class="number">4</span>f * turningRadius));</div><div class="line"></div><div class="line">            <span class="comment">//But we need to modify the angle theta if the circles are not on the same line</span></div><div class="line">            Vector3 V1 = goalCircle - startCircle;</div><div class="line"></div><div class="line">            <span class="comment">//Different depending on if we calculate LRL or RLR</span></div><div class="line">            <span class="keyword">if</span> (isLRL)</div><div class="line">            &#123;</div><div class="line">                theta = Mathf.Atan2(V1.z, V1.x) + theta;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">else</span></div><div class="line">            &#123;</div><div class="line">                theta = Mathf.Atan2(V1.z, V1.x) - theta;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            <span class="comment">//Calculate the position of the third circle</span></div><div class="line">            <span class="keyword">float</span> x = startCircle.x + <span class="number">2</span>f * turningRadius * Mathf.Cos(theta);</div><div class="line">            <span class="keyword">float</span> y = startCircle.y;</div><div class="line">            <span class="keyword">float</span> z = startCircle.z + <span class="number">2</span>f * turningRadius * Mathf.Sin(theta);</div><div class="line"></div><div class="line">            middleCircle = <span class="keyword">new</span> Vector3(x, y, z);</div><div class="line"></div><div class="line">            <span class="comment">//Calculate the tangent points</span></div><div class="line">            Vector3 V2 = (startCircle - middleCircle).normalized;</div><div class="line">            Vector3 V3 = (goalCircle - middleCircle).normalized;</div><div class="line"></div><div class="line">            startTangent = middleCircle + V2 * turningRadius;</div><div class="line">            goalTangent = middleCircle + V3 * turningRadius;</div><div class="line">        &#125;</div><div class="line"></div><div class="line"></div><div class="line">        <span class="comment">//Calculate the length of an circle arc depending on which direction we are driving</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">float</span> <span class="title">GetArcLength</span>(<span class="params"></span></span></div><div class="line">            Vector3 circleCenterPos,</div><div class="line">            Vector3 startPos,</div><div class="line">            Vector3 goalPos,</div><div class="line">            <span class="keyword">bool</span> isLeftCircle)</div><div class="line">        &#123;</div><div class="line">            Vector3 V1 = startPos - circleCenterPos;</div><div class="line">            Vector3 V2 = goalPos - circleCenterPos;</div><div class="line"></div><div class="line">            <span class="keyword">float</span> theta = Mathf.Atan2(V2.z, V2.x) - Mathf.Atan2(V1.z, V1.x);</div><div class="line"></div><div class="line">            <span class="keyword">if</span> (theta &lt; <span class="number">0</span>f &amp;&amp; isLeftCircle)</div><div class="line">            &#123;</div><div class="line">                theta += <span class="number">2</span>f * Mathf.PI;</div><div class="line">            &#125;</div><div class="line">            <span class="function"><span class="keyword">else</span> <span class="title">if</span> (<span class="params">theta &gt; <span class="number">0</span> &amp;&amp; !isLeftCircle</span>)</span></div><div class="line">            &#123;</div><div class="line">                theta -= <span class="number">2</span>f * Mathf.PI;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            <span class="keyword">float</span> arcLength = Mathf.Abs(theta * turningRadius);</div><div class="line"></div><div class="line">            <span class="keyword">return</span> arcLength;</div><div class="line">        &#125;</div><div class="line"></div><div class="line"></div><div class="line">        <span class="comment">//Loops through segments of a path and add new coordinates to the final path</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">AddCoordinatesToPath</span>(<span class="params"></span></span></div><div class="line">            <span class="keyword">ref</span> Vector3 currentPos,</div><div class="line">            <span class="keyword">ref</span> <span class="keyword">float</span> theta,</div><div class="line">            List&lt;Vector3&gt; finalPath,</div><div class="line">            <span class="keyword">int</span> segments,</div><div class="line">            <span class="keyword">bool</span> isTurning,</div><div class="line">            <span class="keyword">bool</span> isTurningRight)</div><div class="line">        &#123;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; segments; i++)</div><div class="line">            &#123;</div><div class="line">                <span class="comment">//Update the position of the car</span></div><div class="line">                currentPos.x += driveDistance * Mathf.Sin(theta);</div><div class="line">                currentPos.z += driveDistance * Mathf.Cos(theta);</div><div class="line"></div><div class="line">                <span class="comment">//Don't update the heading if we are driving straight</span></div><div class="line">                <span class="keyword">if</span> (isTurning)</div><div class="line">                &#123;</div><div class="line">                    <span class="comment">//Which way are we turning?</span></div><div class="line">                    <span class="keyword">float</span> turnParameter = <span class="number">1</span>f;</div><div class="line"></div><div class="line">                    <span class="keyword">if</span> (!isTurningRight)</div><div class="line">                    &#123;</div><div class="line">                        turnParameter = <span class="number">-1</span>f;</div><div class="line">                    &#125;</div><div class="line"></div><div class="line">                    <span class="comment">//Update the heading</span></div><div class="line">                    theta += (driveDistance / turningRadius) * turnParameter;</div><div class="line">                &#125;</div><div class="line"></div><div class="line">                <span class="comment">//Add the new coordinate to the path</span></div><div class="line">                finalPath.Add(currentPos);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Script-5-A-class-that-will-hold-one-Dubins-path"><a href="#Script-5-A-class-that-will-hold-one-Dubins-path" class="headerlink" title="Script 5 - A class that will hold one Dubins path"></a>Script 5 - A class that will hold one Dubins path</h3><p>This final script will hold everything we need when we have generated a Dubins path.</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">using</span> UnityEngine;</div><div class="line"><span class="keyword">using</span> System.Collections;</div><div class="line"><span class="keyword">using</span> System.Collections.Generic;</div><div class="line"></div><div class="line"><span class="keyword">namespace</span> <span class="title">DubinsPathsTutorial</span></div><div class="line">&#123;</div><div class="line">    <span class="comment">//Will hold data related to one Dubins path so we can sort them</span></div><div class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">OneDubinsPath</span></div><div class="line">    &#123;</div><div class="line">        <span class="comment">//Tthe total length of this path</span></div><div class="line">        <span class="keyword">public</span> <span class="keyword">float</span> totalLength;</div><div class="line"></div><div class="line">        <span class="comment">//Need the individual path lengths for debugging and to find the final path</span></div><div class="line">        <span class="keyword">public</span> <span class="keyword">float</span> length1;</div><div class="line">        <span class="keyword">public</span> <span class="keyword">float</span> length2;</div><div class="line">        <span class="keyword">public</span> <span class="keyword">float</span> length3;</div><div class="line"></div><div class="line">        <span class="comment">//The 2 tangent points we need to connect the lines and curves</span></div><div class="line">        <span class="keyword">public</span> Vector3 tangent1;</div><div class="line">        <span class="keyword">public</span> Vector3 tangent2;</div><div class="line"></div><div class="line">        <span class="comment">//The type, such as RSL</span></div><div class="line">        <span class="keyword">public</span> PathType pathType;</div><div class="line"></div><div class="line">        <span class="comment">//The coordinates of the final path</span></div><div class="line">        <span class="keyword">public</span> List&lt;Vector3&gt; pathCoordinates;</div><div class="line"></div><div class="line">        <span class="comment">//To simplify when we generate the final path coordinates</span></div><div class="line">        <span class="comment">//Are we turning or driving straight in segment 2?</span></div><div class="line">        <span class="keyword">public</span> <span class="keyword">bool</span> segment2Turning;</div><div class="line"></div><div class="line">        <span class="comment">//Are we turning right in the particular segment?</span></div><div class="line">        <span class="keyword">public</span> <span class="keyword">bool</span> segment1TurningRight;</div><div class="line">        <span class="keyword">public</span> <span class="keyword">bool</span> segment2TurningRight;</div><div class="line">        <span class="keyword">public</span> <span class="keyword">bool</span> segment3TurningRight;</div><div class="line"></div><div class="line"></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="title">OneDubinsPath</span>(<span class="params"><span class="keyword">float</span> length1, <span class="keyword">float</span> length2, <span class="keyword">float</span> length3, Vector3 tangent1, Vector3 tangent2, PathType pathType</span>)</span></div><div class="line">        &#123;</div><div class="line">            <span class="comment">//Calculate the total length of this path</span></div><div class="line">            <span class="keyword">this</span>.totalLength = length1 + length2 + length3;</div><div class="line"></div><div class="line">            <span class="keyword">this</span>.length1 = length1;</div><div class="line">            <span class="keyword">this</span>.length2 = length2;</div><div class="line">            <span class="keyword">this</span>.length3 = length3;</div><div class="line"></div><div class="line">            <span class="keyword">this</span>.tangent1 = tangent1;</div><div class="line">            <span class="keyword">this</span>.tangent2 = tangent2;</div><div class="line"></div><div class="line">            <span class="keyword">this</span>.pathType = pathType;</div><div class="line">        &#125;</div><div class="line"></div><div class="line"></div><div class="line">        <span class="comment">//Are we turning right in any of the segments?</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">SetIfTurningRight</span>(<span class="params"><span class="keyword">bool</span> segment1TurningRight, <span class="keyword">bool</span> segment2TurningRight, <span class="keyword">bool</span> segment3TurningRight</span>)</span></div><div class="line">        &#123;</div><div class="line">            <span class="keyword">this</span>.segment1TurningRight = segment1TurningRight;</div><div class="line">            <span class="keyword">this</span>.segment2TurningRight = segment2TurningRight;</div><div class="line">            <span class="keyword">this</span>.segment3TurningRight = segment3TurningRight;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>…and if you now press play (and attach a cool camera script to the scene) you should see something like this:</p>
<p><img src="https://raw.githubusercontent.com/tospan/tospan.github.io/source/source/_images/unity/dubins-paths-final.png" alt="The final scene in Unity with Dubins paths"></p>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul>
<li><a href="http://www.habrador.com/tutorials/unity-dubins-paths/" target="_blank" rel="external">How to make Dubins Paths in Unity with C# code</a></li>
<li><a href="http://blog.csdn.net/robinvista/article/details/54141762" target="_blank" rel="external">Reeds-Shepp曲线和Dubins曲线</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://tospan.me/2017/02/05/How-to-make-Dubins-Paths-in-Unity/" data-id="ciyu4ntek000l2tvw9ak078s4" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Geometry/">Geometry</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Math/">Math</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Unity/">Unity</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2017/02/05/Interpolation-in-Unity/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Everything about interpolation in Unity with C#
        
      </div>
    </a>
  
  
    <a href="/2017/02/05/Are-two-rectangles-with-orientation-in-2D-space-intersecting/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Are two rectangles with orientation in 2D space intersecting</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Math/">Math</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Unity/">Unity</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Basics/">Basics</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/C/">C#</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Games/">Games</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Geometry/">Geometry</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linear-Algebra/">Linear Algebra</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Math/">Math</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Numerical-Analysis/">Numerical Analysis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Unity/">Unity</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/default/">default</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Basics/" style="font-size: 15px;">Basics</a> <a href="/tags/C/" style="font-size: 13.33px;">C#</a> <a href="/tags/Games/" style="font-size: 10px;">Games</a> <a href="/tags/Geometry/" style="font-size: 11.67px;">Geometry</a> <a href="/tags/Linear-Algebra/" style="font-size: 16.67px;">Linear Algebra</a> <a href="/tags/Math/" style="font-size: 18.33px;">Math</a> <a href="/tags/Numerical-Analysis/" style="font-size: 10px;">Numerical Analysis</a> <a href="/tags/Unity/" style="font-size: 20px;">Unity</a> <a href="/tags/default/" style="font-size: 10px;">default</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">February 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">January 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/12/">December 2012</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2017/02/06/Math-3D/">3D数学</a>
          </li>
        
          <li>
            <a href="/2017/02/06/Unity-Engine-Core-Concept/">Unity引擎重要概念</a>
          </li>
        
          <li>
            <a href="/2017/02/06/Unity-Scripting-2D-Code-Snippet/">Unity编程 2D脚本常用代码集合</a>
          </li>
        
          <li>
            <a href="/2017/02/06/Unity-Scripting-Core/">Unity编程要点</a>
          </li>
        
          <li>
            <a href="/2017/02/06/C-Sharp-Essential/">C#要点</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 To Span<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>